<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WAAPI å·¥å…·ç®±</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --bg-primary: white;
            --bg-secondary: #f5f5f5;
            --bg-tertiary: #f8f9fa;
            --text-primary: #333;
            --text-secondary: #666;
            --text-tertiary: #999;
            --border-color: #ddd;
            --input-bg: white;
            --input-border: #ddd;
            --status-bg: #f5f5f5;
            --table-hover: #f5f5f5;
            --shadow: rgba(0,0,0,0.2);
            --primary-color: #667eea;
            --success-color: #4CAF50;
            --danger-color: #f44336;
            --warning-color: #ff9800;
            --body-gradient-start: #667eea;
            --body-gradient-end: #764ba2;
            --info-box-bg: #e3f2fd;
            --info-box-border: #2196F3;
        }

        [data-theme="dark"] {
            --bg-primary: #1e1e1e;
            --bg-secondary: #2d2d2d;
            --bg-tertiary: #252525;
            --text-primary: #e0e0e0;
            --text-secondary: #b0b0b0;
            --text-tertiary: #808080;
            --border-color: #404040;
            --input-bg: #2d2d2d;
            --input-border: #404040;
            --status-bg: #2d2d2d;
            --table-hover: #353535;
            --shadow: rgba(0,0,0,0.5);
            --body-gradient-start: #1a1a2e;
            --body-gradient-end: #16213e;
            --info-box-bg: #1e3a5f;
            --info-box-border: #4a90e2;
        }

        [data-theme="dark"] tbody tr:nth-child(even) {
            background: rgba(102, 126, 234, 0.05);
        }

        [data-theme="dark"] tbody tr:hover {
            background: rgba(102, 126, 234, 0.15);
        }

        [data-theme="dark"] .empty-state {
            background: linear-gradient(135deg, rgba(102, 126, 234, 0.05) 0%, rgba(118, 75, 162, 0.05) 100%);
        }

        [data-theme="dark"] .results-header {
            background: linear-gradient(135deg, rgba(102, 126, 234, 0.1) 0%, rgba(118, 75, 162, 0.1) 100%);
        }

        [data-theme="dark"] .info-box {
            background: linear-gradient(135deg, rgba(33, 150, 243, 0.15) 0%, rgba(33, 150, 243, 0.1) 100%);
        }

        [data-theme="dark"] .header-controls::after {
            background: linear-gradient(90deg, 
                transparent 0%, 
                rgba(102, 126, 234, 0.3) 20%, 
                rgba(102, 126, 234, 0.5) 50%, 
                rgba(102, 126, 234, 0.3) 80%, 
                transparent 100%);
            box-shadow: 0 1px 2px rgba(102, 126, 234, 0.2);
        }

        [data-theme="dark"] .tabs::after {
            background: linear-gradient(90deg, 
                transparent 0%, 
                rgba(102, 126, 234, 0.4) 10%, 
                rgba(102, 126, 234, 0.6) 50%, 
                rgba(102, 126, 234, 0.4) 90%, 
                transparent 100%);
            box-shadow: 0 2px 4px rgba(102, 126, 234, 0.25);
        }

        [data-theme="dark"] .tab.active {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            box-shadow: 0 -2px 8px rgba(102, 126, 234, 0.4);
        }

        [data-theme="dark"] .tab:hover {
            background: rgba(102, 126, 234, 0.1);
        }

        [data-theme="dark"] .tab.active {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            box-shadow: 0 -2px 8px rgba(102, 126, 234, 0.4);
        }

        [data-theme="dark"] .tab:hover {
            background: rgba(102, 126, 234, 0.1);
        }

        body {
            font-family: 'Microsoft YaHei', Arial, sans-serif;
            background: linear-gradient(135deg, var(--body-gradient-start) 0%, var(--body-gradient-end) 100%);
            padding: 20px;
            height: 100vh;
            overflow: hidden;
            transition: background 0.3s ease;
        }

        .container {
            background: var(--bg-primary);
            border-radius: 10px;
            padding: 30px;
            height: calc(100vh - 40px);
            display: flex;
            flex-direction: column;
            box-shadow: 0 10px 40px var(--shadow);
        }

        h1 {
            color: var(--text-primary);
            margin-bottom: 20px;
            text-align: center;
        }

        .header-controls {
            display: flex;
            gap: 15px;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 20px;
            position: relative;
        }

        .header-controls::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            height: 1px;
            background: linear-gradient(90deg, 
                transparent 0%, 
                rgba(102, 126, 234, 0.2) 20%, 
                rgba(102, 126, 234, 0.4) 50%, 
                rgba(102, 126, 234, 0.2) 80%, 
                transparent 100%);
            box-shadow: 0 1px 2px rgba(102, 126, 234, 0.1);
        }

        .input-group {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .input-group label {
            font-size: 14px;
            white-space: nowrap;
            color: var(--text-secondary);
            font-weight: bold;
        }

        input[type="number"], input[type="text"] {
            padding: 8px 12px;
            border: 2px solid var(--input-border);
            border-radius: 5px;
            font-size: 14px;
            background: var(--input-bg);
            color: var(--text-primary);
            transition: all 0.3s ease;
        }

        input[type="number"]:focus, input[type="text"]:focus {
            outline: none;
            border-color: var(--primary-color);
        }

        .status-indicator {
            display: inline-block;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            margin-right: 8px;
        }

        .status-indicator.connected {
            background: var(--success-color);
        }

        .status-indicator.disconnected {
            background: #ccc;
        }

        .status-text {
            font-size: 14px;
            color: var(--text-secondary);
        }

        .tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            position: relative;
            padding-bottom: 0;
        }

        .tabs::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            height: 2px;
            background: linear-gradient(90deg, 
                transparent 0%, 
                rgba(102, 126, 234, 0.3) 10%, 
                rgba(102, 126, 234, 0.5) 50%, 
                rgba(102, 126, 234, 0.3) 90%, 
                transparent 100%);
            box-shadow: 0 2px 4px rgba(102, 126, 234, 0.15);
            border-radius: 1px;
        }

        .tab {
            padding: 12px 24px;
            background: transparent;
            border: none;
            border-bottom: 3px solid transparent;
            cursor: pointer;
            font-size: 14px;
            font-weight: bold;
            color: var(--text-secondary);
            transition: all 0.3s;
            border-radius: 8px 8px 0 0;
            position: relative;
        }

        .tab:hover {
            color: var(--primary-color);
            background: rgba(102, 126, 234, 0.05);
        }

        .tab.active {
            color: white;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-bottom-color: transparent;
            box-shadow: 0 -2px 8px rgba(102, 126, 234, 0.3);
            z-index: 1;
        }

        .tab.active::before {
            content: '';
            position: absolute;
            bottom: -2px;
            left: 0;
            right: 0;
            height: 2px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }

        .tab-content {
            flex: 1;
            overflow: hidden;
            display: none;
            flex-direction: column;
        }

        .tab-content.active {
            display: flex;
        }

        .tool-panel {
            display: flex;
            flex-direction: column;
            gap: 15px;
            margin-bottom: 15px;
        }

        .tool-controls {
            display: flex;
            gap: 10px;
            align-items: center;
            flex-wrap: wrap;
        }

        button {
            padding: 10px 20px;
            border: none;
            border-radius: 6px;
            font-size: 14px;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.2s ease;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            box-shadow: 0 2px 8px rgba(102, 126, 234, 0.3);
        }

        .btn-primary:hover {
            background: linear-gradient(135deg, #5568d3 0%, #6a3d8f 100%);
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.4);
            transform: translateY(-1px);
        }

        .btn-primary:active {
            transform: translateY(0);
            box-shadow: 0 2px 4px rgba(102, 126, 234, 0.3);
        }

        .btn-primary:disabled {
            background: #d0d0d0;
            color: #888;
            cursor: not-allowed;
            box-shadow: none;
            transform: none;
        }

        .btn-success {
            background: linear-gradient(135deg, #4CAF50 0%, #45a049 100%);
            color: white;
            box-shadow: 0 2px 8px rgba(76, 175, 80, 0.3);
        }

        .btn-success:hover {
            background: linear-gradient(135deg, #45a049 0%, #3d8b40 100%);
            box-shadow: 0 4px 12px rgba(76, 175, 80, 0.4);
            transform: translateY(-1px);
        }

        .btn-success:active {
            transform: translateY(0);
            box-shadow: 0 2px 4px rgba(76, 175, 80, 0.3);
        }

        .btn-danger {
            background: linear-gradient(135deg, #f44336 0%, #d32f2f 100%);
            color: white;
            box-shadow: 0 2px 8px rgba(244, 67, 54, 0.3);
        }

        .btn-danger:hover {
            background: linear-gradient(135deg, #e53935 0%, #c62828 100%);
            box-shadow: 0 4px 12px rgba(244, 67, 54, 0.4);
            transform: translateY(-1px);
        }

        .btn-danger:active {
            transform: translateY(0);
            box-shadow: 0 2px 4px rgba(244, 67, 54, 0.3);
        }

        .btn-danger:disabled {
            background: #d0d0d0;
            color: #888;
            cursor: not-allowed;
            box-shadow: none;
            transform: none;
        }

        .btn-secondary {
            background: linear-gradient(135deg, #6c757d 0%, #5a6268 100%);
            color: white;
            box-shadow: 0 2px 6px rgba(108, 117, 125, 0.25);
        }

        .btn-secondary:hover {
            background: linear-gradient(135deg, #5a6268 0%, #495057 100%);
            box-shadow: 0 3px 8px rgba(108, 117, 125, 0.35);
            transform: translateY(-1px);
        }

        .btn-secondary:active {
            transform: translateY(0);
            box-shadow: 0 2px 4px rgba(108, 117, 125, 0.25);
        }

        .radio-group {
            display: flex;
            gap: 20px;
            align-items: center;
        }

        .radio-group label {
            display: flex;
            align-items: center;
            gap: 6px;
            cursor: pointer;
            font-size: 14px;
            color: var(--text-primary);
        }

        input[type="radio"] {
            cursor: pointer;
        }

        .checkbox-group {
            display: flex;
            gap: 20px;
            align-items: center;
        }

        .checkbox-group label {
            display: flex;
            align-items: center;
            gap: 6px;
            cursor: pointer;
            font-size: 14px;
            color: var(--text-primary);
        }

        input[type="checkbox"] {
            cursor: pointer;
        }

        .btn-locate {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 6px 8px;
            font-size: 14px;
            border-radius: 5px;
            border: none;
            cursor: pointer;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 32px;
            height: 32px;
            transition: all 0.2s ease;
            box-shadow: 0 2px 4px rgba(102, 126, 234, 0.25);
        }

        .btn-locate:hover {
            background: linear-gradient(135deg, #5568d3 0%, #6a3d8f 100%);
            transform: translateY(-2px) scale(1.05);
            box-shadow: 0 4px 8px rgba(102, 126, 234, 0.35);
        }

        .btn-locate:active {
            transform: translateY(0) scale(1);
            box-shadow: 0 2px 4px rgba(102, 126, 234, 0.25);
        }

        .btn-locate svg {
            width: 16px;
            height: 16px;
            fill: currentColor;
        }

        .path-display {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 8px 12px;
            background: var(--bg-secondary);
            border-radius: 5px;
            border: 1px solid var(--border-color);
        }

        .path-display span {
            flex: 1;
            font-size: 13px;
            color: var(--text-secondary);
            word-break: break-all;
        }

        .results-container {
            flex: 1;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            border: 1px solid var(--border-color);
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
            background: var(--bg-primary);
        }

        .results-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 14px 18px;
            background: linear-gradient(135deg, rgba(102, 126, 234, 0.05) 0%, rgba(118, 75, 162, 0.05) 100%);
            border-bottom: 2px solid var(--border-color);
            border-radius: 8px 8px 0 0;
        }

        .results-header-actions {
            display: flex;
            gap: 10px;
            align-items: center;
        }

        .btn-clear {
            background: linear-gradient(135deg, #ff9800 0%, #f57c00 100%);
            color: white;
            padding: 6px 12px;
            font-size: 12px;
            box-shadow: 0 2px 6px rgba(255, 152, 0, 0.25);
        }

        .btn-clear:hover {
            background: linear-gradient(135deg, #f57c00 0%, #e65100 100%);
            box-shadow: 0 3px 8px rgba(255, 152, 0, 0.35);
            transform: translateY(-1px);
        }

        .btn-clear:active {
            transform: translateY(0);
            box-shadow: 0 2px 4px rgba(255, 152, 0, 0.25);
        }

        .btn-clear:disabled {
            background: #d0d0d0;
            color: #888;
            cursor: not-allowed;
            box-shadow: none;
            transform: none;
        }

        .results-title {
            font-size: 16px;
            font-weight: bold;
            color: var(--text-primary);
        }

        .results-count {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 6px 16px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 500;
            box-shadow: 0 2px 6px rgba(102, 126, 234, 0.3);
            letter-spacing: 0.3px;
        }

        .results-table {
            flex: 1;
            overflow-y: auto;
            background: var(--bg-primary);
        }

        .results-table::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }

        .results-table::-webkit-scrollbar-track {
            background: var(--bg-secondary);
            border-radius: 4px;
        }

        .results-table::-webkit-scrollbar-thumb {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 4px;
        }

        .results-table::-webkit-scrollbar-thumb:hover {
            background: linear-gradient(135deg, #5568d3 0%, #6a3d8f 100%);
        }

        table {
            width: 100%;
            border-collapse: separate;
            border-spacing: 0;
        }

        thead {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            position: sticky;
            top: 0;
            z-index: 10;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        th, td {
            padding: 14px 12px;
            text-align: left;
            color: var(--text-primary);
        }

        th {
            font-weight: 600;
            color: white;
            font-size: 13px;
            letter-spacing: 0.3px;
            border-bottom: none;
        }

        tbody tr {
            border-bottom: 1px solid var(--border-color);
            transition: all 0.15s ease;
        }

        tbody tr:last-child {
            border-bottom: none;
        }

        /* è¡¨æ ¼åˆ—å®½åº¦ä¼˜åŒ– - é¿å…æ ‡é¢˜æ¢è¡Œ */
        
        /* é‡ç½®éŸ³é‡æ¨å­è¡¨æ ¼ */
        #resetFadersThLocate { width: 60px; min-width: 60px; }
        #resetFadersThIndex { width: 60px; min-width: 60px; }
        #resetFadersThName { width: 200px; min-width: 150px; }
        #resetFadersThType { width: 80px; min-width: 80px; }
        #resetFadersThVolume { width: 80px; min-width: 80px; }
        #resetFadersThStatus { width: 80px; min-width: 80px; }
        
        /* åˆ é™¤æ— æ•ˆEventè¡¨æ ¼ */
        #deleteEventsThLocate { width: 60px; min-width: 60px; }
        #deleteEventsThIndex { width: 60px; min-width: 60px; }
        #deleteEventsThName { width: 180px; min-width: 150px; }
        #deleteEventsThReason { width: 200px; min-width: 180px; }
        #deleteEventsThGuid { width: auto; min-width: 200px; }
        
        /* æ— æ•ˆåŸå› åˆ—å†…å®¹å­—ä½“å°ä¸€äº›ï¼Œé¿å…æ¢è¡Œ */
        #deleteEventsBody td:nth-child(4) {
            font-size: 12px;
            white-space: nowrap;
        }
        
        /* è®¾ç½®æµæ’­æ”¾è¡¨æ ¼ */
        #setStreamingThLocate { width: 60px; min-width: 60px; }
        #setStreamingThIndex { width: 60px; min-width: 60px; }
        #setStreamingThName { width: 200px; min-width: 150px; }
        #setStreamingThDuration { width: 120px; min-width: 120px; white-space: nowrap; }
        #setStreamingThShouldSet { width: 90px; min-width: 90px; white-space: nowrap; }
        #setStreamingThStatus { width: 140px; min-width: 140px; white-space: nowrap; }
        
        /* åˆ é™¤æœªä½¿ç”¨WAVè¡¨æ ¼ */
        #removeWavsThIndex { width: 60px; min-width: 60px; }
        #removeWavsThPath { width: auto; min-width: 300px; }
        #removeWavsThSize { width: 100px; min-width: 100px; white-space: nowrap; }
        #removeWavsThMtime { width: 160px; min-width: 160px; white-space: nowrap; }
        
        /* éŸ³é¢‘å½•åˆ¶è¡¨æ ¼ */
        #recordingThIndex { width: 60px; min-width: 60px; }
        #recordingThFileName { width: auto; min-width: 200px; }
        #recordingThActions { width: 100px; min-width: 100px; }
        
        /* æ‰€æœ‰è¡¨å¤´ä¸æ¢è¡Œ */
        th {
            white-space: nowrap;
        }

        tbody tr:nth-child(even) {
            background: rgba(102, 126, 234, 0.02);
        }

        tbody tr:hover {
            background: rgba(102, 126, 234, 0.08);
            transform: scale(1.001);
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);
        }

        tbody tr:active {
            background: rgba(102, 126, 234, 0.12);
        }

        .empty-state {
            text-align: center;
            padding: 50px 40px;
            color: var(--text-tertiary);
            font-size: 14px;
            font-style: italic;
            background: linear-gradient(135deg, rgba(102, 126, 234, 0.02) 0%, rgba(118, 75, 162, 0.02) 100%);
        }

        .info-box {
            padding: 14px 18px;
            background: linear-gradient(135deg, rgba(33, 150, 243, 0.08) 0%, rgba(33, 150, 243, 0.05) 100%);
            border-left: 4px solid #2196F3;
            border-radius: 6px;
            margin-bottom: 18px;
            font-size: 13px;
            color: var(--text-primary);
            line-height: 1.6;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);
        }

        .settings-controls {
            display: flex;
            gap: 8px;
            align-items: center;
            margin-left: auto;
        }


        .theme-btn, .lang-btn {
            width: 36px;
            height: 36px;
            padding: 0;
            border: 2px solid var(--border-color);
            border-radius: 5px;
            background: var(--bg-secondary);
            color: var(--text-primary);
            font-size: 18px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .theme-btn:hover, .lang-btn:hover {
            background: var(--bg-tertiary);
            border-color: var(--primary-color);
            transform: scale(1.05);
        }

        .btn-connect {
            padding: 6px 16px;
            border: 2px solid var(--primary-color);
            border-radius: 5px;
            background: var(--primary-color);
            color: white;
            font-size: 14px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            white-space: nowrap;
        }

        .btn-connect:hover {
            background: var(--primary-color-hover, #0056b3);
            border-color: var(--primary-color-hover, #0056b3);
            transform: translateY(-1px);
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
        }

        .btn-connect:active {
            transform: translateY(0);
        }

        .btn-connect:disabled {
            background: var(--bg-tertiary);
            border-color: var(--border-color);
            color: var(--text-secondary);
            cursor: not-allowed;
            transform: none;
        }

        .progress-bar {
            height: 6px;
            background: var(--bg-secondary);
            border-radius: 3px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: var(--primary-color);
            transition: width 0.3s;
            width: 0%;
        }

        .help-text {
            font-size: 11px;
            color: #856404;
            background: #fff3cd;
            padding: 8px;
            border-radius: 6px;
            border-left: 4px solid #ffc107;
            margin-top: 5px;
            line-height: 1.5;
        }

        .help-text strong {
            color: #856404;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ”§ WAAPI å·¥å…·ç®±</h1>
        
        <div class="header-controls">
            <div class="input-group">
                <label>ç«¯å£:</label>
                <input type="number" id="portInput" value="8080" min="1" max="65535" style="width: 80px;">
                <button class="btn-connect" id="reconnectBtn" title="é‡æ–°è¿æ¥">è¿æ¥</button>
            </div>
            <div class="status-indicator disconnected" id="statusIndicator"></div>
            <span class="status-text" id="statusText">æœªè¿æ¥</span>
            <div class="settings-controls">
                <button class="theme-btn" id="themeToggleBtn" title="åˆ‡æ¢ä¸»é¢˜">â˜€ï¸</button>
                <button class="lang-btn" id="langToggleBtn" title="åˆ‡æ¢è¯­è¨€">ä¸­</button>
            </div>
        </div>

        <div class="tabs">
            <button class="tab" data-tab="audio-recording">éŸ³é¢‘å½•åˆ¶</button>
            <button class="tab active" data-tab="reset-faders">é‡ç½®éŸ³é‡æ¨å­</button>
            <button class="tab" data-tab="delete-events">åˆ é™¤æ— æ•ˆEvent</button>
            <button class="tab" data-tab="set-streaming">è®¾ç½®æµæ’­æ”¾</button>
            <button class="tab" data-tab="remove-wavs">åˆ é™¤æœªä½¿ç”¨WAV</button>
        </div>

        <!-- éŸ³é¢‘å½•åˆ¶æ ‡ç­¾ -->
        <div class="tab-content" id="audio-recording-tab">
            <div class="info-box" id="audioRecordingInfoBox">
                å½•åˆ¶Wwiseä¸­é€‰ä¸­çš„éŸ³é¢‘å¯¹è±¡ã€‚æ”¯æŒè‡ªåŠ¨æ¨¡å¼ï¼ˆæ’­æ”¾å®Œæˆåè‡ªåŠ¨åœæ­¢ï¼‰å’Œæ‰‹åŠ¨æ¨¡å¼ï¼ˆæŒ‡å®šå½•åˆ¶æ—¶é•¿ï¼‰ã€‚
            </div>
            <div class="tool-panel">
                <div class="tool-controls">
                    <div class="input-group" style="flex: 0 1 auto; max-width: 500px;">
                        <label id="recordingPathLabel" style="min-width: 80px;">å½•åˆ¶è·¯å¾„:</label>
                        <input type="text" id="recordingPathInput" placeholder="ä» Wwise Recorder æ’ä»¶å¤åˆ¶è·¯å¾„..." style="flex: 1; min-width: 180px; max-width: 300px;">
                        <button class="btn-primary" id="selectRecordingPathBtn" style="padding: 6px 12px; font-size: 12px; white-space: nowrap;">é€‰æ‹©</button>
                        <button class="btn-secondary" id="recordingPathHelpBtn" style="padding: 6px 10px; font-size: 12px;" title="å¦‚ä½•è·å–å½•åˆ¶è·¯å¾„">?</button>
                    </div>
                    <div class="input-group" style="margin-left: 20px;">
                        <button class="btn-primary" id="startRecordingBtn">å¼€å§‹å½•åˆ¶</button>
                        <button class="btn-danger" id="stopRecordingBtn" disabled>åœæ­¢</button>
                    </div>
                    <div class="input-group" style="margin-left: 20px;">
                        <label id="recordingModeLabel" style="min-width: 70px;">å½•åˆ¶æ¨¡å¼:</label>
                        <div class="radio-group">
                            <label>
                                <input type="radio" name="recordingMode" value="auto" checked>
                                <span id="recordingModeAuto">è‡ªåŠ¨</span>
                            </label>
                            <label>
                                <input type="radio" name="recordingMode" value="manual">
                                <span id="recordingModeManual">æ‰‹åŠ¨</span>
                            </label>
                        </div>
                        <div class="input-group" id="recordingDurationGroup" style="display: none; margin-left: 10px;">
                            <label id="recordingDurationLabel" style="min-width: auto;">æ—¶é•¿:</label>
                            <input type="number" id="recordingDurationInput" value="10" min="1" max="3600" step="1" style="width: 60px;">
                            <span id="recordingDurationUnit" style="font-size: 13px; margin-left: 4px;">ç§’</span>
                        </div>
                    </div>
                </div>
                <div class="help-text" id="recordingPathHelpText" style="display: none; margin-top: 10px; padding: 8px; background: #fff3cd; border-left: 4px solid #ffc107; border-radius: 4px; font-size: 12px; color: #856404;">
                    <strong id="recordingPathHelpTitle">ğŸ“‹ å¦‚ä½•è·å–å½•åˆ¶è·¯å¾„ï¼š</strong><br>
                    <span id="recordingPathHelp1">1. åœ¨ Wwise ä¸­æ‰“å¼€ Master Bus â†’ Effect Chain â†’ Recorder æ’ä»¶</span><br>
                    <span id="recordingPathHelp2">2. åœ¨ "Authoring Tool Output Path" ä¸­è®¾ç½®è·¯å¾„</span><br>
                    <span id="recordingPathHelp3">3. ç¡®ä¿æ–‡ä»¶åä½¿ç”¨ "Record.wav"</span><br>
                    <span id="recordingPathHelp4">4. å°†å®Œæ•´è·¯å¾„å¤åˆ¶åˆ°ä¸Šæ–¹è¾“å…¥æ¡†ï¼ˆä¾‹å¦‚ï¼šC:\Users\...\Record.wavï¼‰</span><br>
                    <strong id="recordingPathHelpNote">æ³¨æ„ï¼šå·¥å…·ä¼šåœ¨å½•åˆ¶å®Œæˆåè‡ªåŠ¨å°† Record.wav é‡å‘½åä¸ºå¯¹åº”å¯¹è±¡åç§°</strong>
                </div>
            </div>
            <div class="results-container" style="margin-top: 15px;">
                <div class="results-header">
                    <span class="results-title" id="recordingStatusTitle">å½•åˆ¶çŠ¶æ€</span>
                    <div class="results-header-actions">
                        <span class="results-count" id="recordingProgressText" style="background: transparent; color: var(--text-secondary);">å°±ç»ª</span>
                        <button class="btn-primary" id="openRecordingFolderBtn" style="display: none; padding: 6px 12px; font-size: 12px;">ğŸ“‚ æ‰“å¼€æ–‡ä»¶å¤¹</button>
                    </div>
                </div>
                <div class="progress-bar" id="recordingProgressBar" style="display: none; margin: 10px 15px;">
                    <div class="progress-fill" id="recordingProgressFill"></div>
                </div>
                <div class="results-table" style="max-height: 300px; overflow-y: auto;">
                    <table>
                        <thead>
                            <tr>
                                <th id="recordingThIndex">åºå·</th>
                                <th id="recordingThFileName">æ–‡ä»¶å</th>
                                <th id="recordingThActions">æ“ä½œ</th>
                            </tr>
                        </thead>
                        <tbody id="recordingResultsBody">
                            <tr>
                                <td colspan="3" class="empty-state" id="recordingEmptyState"></td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- é‡ç½®éŸ³é‡æ¨å­æ ‡ç­¾ -->
        <div class="tab-content active" id="reset-faders-tab">
            <div class="info-box">
                é‡ç½®é€‰ä¸­å¯¹è±¡çš„éŸ³é‡æ¨å­ã€‚å¯ä»¥é€‰æ‹©ä»…é‡ç½®é€‰ä¸­å¯¹è±¡æœ¬èº«ï¼Œæˆ–é‡ç½®é€‰ä¸­å¯¹è±¡åŠå…¶æ‰€æœ‰å­å¯¹è±¡ã€‚
            </div>
            <div class="tool-panel">
                <div class="tool-controls">
                    <div class="checkbox-group">
                        <label>
                            <input type="checkbox" name="resetScope" value="selected" checked>
                            <span id="resetScopeSelected">ä»…é€‰ä¸­å¯¹è±¡</span>
                        </label>
                        <label>
                            <input type="checkbox" name="resetScope" value="children" checked>
                            <span id="resetScopeChildren">é€‰ä¸­å¯¹è±¡+å­å¯¹è±¡</span>
                        </label>
                    </div>
                    <button class="btn-primary" id="resetFadersScanBtn">å¼€å§‹æ£€æµ‹</button>
                    <button class="btn-success" id="resetFadersConfirmBtn" style="display: none;">ç¡®è®¤é‡ç½®</button>
                </div>
            </div>
            <div class="results-container">
                <div class="results-header">
                    <span class="results-title" id="resetFadersResultsTitle">æ£€æµ‹ç»“æœ</span>
                    <div class="results-header-actions">
                        <span class="results-count" id="resetFadersCount">0 ä¸ªå¯¹è±¡</span>
                        <span class="results-count" id="resetFadersNonZeroCount" style="margin-left: 10px; color: var(--warning-color, #ff9800); display: none;"></span>
                        <button class="btn-primary" id="resetFadersListViewBtn" style="display: none; padding: 6px 12px; font-size: 12px;">æ˜¾ç¤ºåˆ°List View</button>
                        <button class="btn-primary" id="resetFadersMultiEditorBtn" style="display: none; padding: 6px 12px; font-size: 12px;">æ˜¾ç¤ºåˆ°Multi Editor</button>
                        <button class="btn-clear" id="resetFadersClearBtn">æ¸…é™¤ç»“æœ</button>
                    </div>
                </div>
                <div id="resetFadersNonZeroList" style="display: none; margin-top: 10px; padding: 10px; background: var(--bg-secondary, #f5f5f5); border-radius: 4px; max-height: 200px; overflow-y: auto;">
                    <div style="font-weight: bold; margin-bottom: 8px; color: var(--warning-color, #ff9800);" id="resetFadersNonZeroListTitle">æœªå½’é›¶å¯¹è±¡ï¼š</div>
                    <div id="resetFadersNonZeroListContent"></div>
                </div>
                <div class="results-table">
                    <table>
                        <thead>
                            <tr>
                                <th id="resetFadersThLocate">å®šä½</th>
                                <th id="resetFadersThIndex">åºå·</th>
                                <th id="resetFadersThName">å¯¹è±¡åç§°</th>
                                <th id="resetFadersThType">ç±»å‹</th>
                                <th id="resetFadersThVolume">åŸéŸ³é‡</th>
                                <th id="resetFadersThStatus">çŠ¶æ€</th>
                            </tr>
                        </thead>
                        <tbody id="resetFadersBody">
                            <tr>
                                <td colspan="6" class="empty-state" id="resetFadersEmptyState">è¯·ç‚¹å‡»"å¼€å§‹æ£€æµ‹"æŒ‰é’®</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- åˆ é™¤æ— æ•ˆEventæ ‡ç­¾ -->
        <div class="tab-content" id="delete-events-tab">
            <div class="info-box" id="deleteEventsInfoBox">
                æ‰«æå·¥ç¨‹ä¸­æ‰€æœ‰Eventï¼Œæ‰¾å‡ºæ‰€æœ‰Actionéƒ½å¼•ç”¨ä¸å­˜åœ¨å¯¹è±¡çš„æ— æ•ˆEventã€‚
            </div>
            <div class="tool-panel">
                <div class="tool-controls">
                    <button class="btn-primary" id="deleteEventsScanBtn">æ‰«ææ— æ•ˆEvent</button>
                    <button class="btn-danger" id="deleteEventsConfirmBtn" style="display: none;">ç¡®è®¤åˆ é™¤</button>
                </div>
            </div>
            <div class="results-container">
                <div class="results-header">
                    <span class="results-title" id="deleteEventsResultsTitle">æ‰«æç»“æœ</span>
                    <div class="results-header-actions">
                        <span class="results-count" id="deleteEventsCount">0 ä¸ªEvent</span>
                        <button class="btn-primary" id="deleteEventsListViewBtn" style="display: none; padding: 6px 12px; font-size: 12px;">æ˜¾ç¤ºåˆ°List View</button>
                        <button class="btn-primary" id="deleteEventsMultiEditorBtn" style="display: none; padding: 6px 12px; font-size: 12px;">æ˜¾ç¤ºåˆ°Multi Editor</button>
                        <button class="btn-clear" id="deleteEventsClearBtn">æ¸…é™¤ç»“æœ</button>
                    </div>
                </div>
                <div class="results-table">
                    <table>
                        <thead>
                            <tr>
                                <th id="deleteEventsThLocate">å®šä½</th>
                                <th id="deleteEventsThIndex">åºå·</th>
                                <th id="deleteEventsThName">Eventåç§°</th>
                                <th id="deleteEventsThReason">æ— æ•ˆåŸå› </th>
                                <th id="deleteEventsThGuid">è·¯å¾„</th>
                            </tr>
                        </thead>
                        <tbody id="deleteEventsBody">
                            <tr>
                                <td colspan="5" class="empty-state" id="deleteEventsEmptyState">è¯·ç‚¹å‡»"æ‰«ææ— æ•ˆEvent"æŒ‰é’®</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- è®¾ç½®æµæ’­æ”¾æ ‡ç­¾ -->
        <div class="tab-content" id="set-streaming-tab">
            <div class="info-box" id="setStreamingInfoBox">
                æ£€æµ‹é€‰ä¸­å®¹å™¨ä¸‹çš„æ‰€æœ‰Soundå¯¹è±¡ï¼Œä¸ºæ—¶é•¿è¶…è¿‡é˜ˆå€¼çš„å¯¹è±¡è®¾ç½®æµæ’­æ”¾å±æ€§ã€‚
            </div>
            <div class="tool-panel">
                <div class="tool-controls">
                    <div class="input-group">
                        <label id="setStreamingThresholdLabel">æ—¶é•¿é˜ˆå€¼ï¼ˆç§’ï¼‰:</label>
                        <input type="number" id="streamingThreshold" value="10" min="0" step="0.1" style="width: 100px;">
                    </div>
                    <button class="btn-primary" id="setStreamingScanBtn">æ£€æµ‹é€‰ä¸­å®¹å™¨</button>
                    <button class="btn-success" id="setStreamingConfirmBtn" style="display: none;">ç¡®è®¤è®¾ç½®</button>
                </div>
            </div>
            <div class="results-container">
                <div class="results-header">
                    <span class="results-title" id="setStreamingResultsTitle">æ£€æµ‹ç»“æœ</span>
                    <div class="results-header-actions">
                        <span class="results-count" id="setStreamingCount">0 ä¸ªå¯¹è±¡</span>
                        <button class="btn-primary" id="setStreamingListViewBtn" style="display: none; padding: 6px 12px; font-size: 12px;">æ˜¾ç¤ºåˆ°List View</button>
                        <button class="btn-primary" id="setStreamingMultiEditorBtn" style="display: none; padding: 6px 12px; font-size: 12px;">æ˜¾ç¤ºåˆ°Multi Editor</button>
                        <button class="btn-clear" id="setStreamingClearBtn">æ¸…é™¤ç»“æœ</button>
                    </div>
                </div>
                <div class="results-table">
                    <table>
                        <thead>
                            <tr>
                                <th id="setStreamingThLocate">å®šä½</th>
                                <th id="setStreamingThIndex">åºå·</th>
                                <th id="setStreamingThName">å¯¹è±¡åç§°</th>
                                <th id="setStreamingThDuration">å½“å‰æ—¶é•¿ï¼ˆç§’ï¼‰</th>
                                <th id="setStreamingThShouldSet">æ»¡è¶³æ¡ä»¶</th>
                                <th id="setStreamingThStatus">å½“å‰æµæ’­æ”¾çŠ¶æ€</th>
                            </tr>
                        </thead>
                        <tbody id="setStreamingBody">
                            <tr>
                                <td colspan="6" class="empty-state" id="setStreamingEmptyState">è¯·ç‚¹å‡»"æ£€æµ‹é€‰ä¸­å®¹å™¨"æŒ‰é’®</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- åˆ é™¤æœªä½¿ç”¨WAVæ ‡ç­¾ -->
        <div class="tab-content" id="remove-wavs-tab">
            <div class="info-box" id="removeWavsInfoBox">
                æ‰«æOriginalsæ–‡ä»¶å¤¹ï¼Œæ‰¾å‡ºæœªè¢«ä»»ä½•Soundå¯¹è±¡å¼•ç”¨çš„WAVæ–‡ä»¶ã€‚
            </div>
            <div class="tool-panel">
                <div class="tool-controls">
                    <div class="path-display">
                        <span id="originalsPath">æœªé€‰æ‹©æ–‡ä»¶å¤¹</span>
                        <button class="btn-primary" id="selectOriginalsBtn" style="padding: 6px 12px; font-size: 12px;">é€‰æ‹©æ–‡ä»¶å¤¹</button>
                    </div>
                    <button class="btn-primary" id="removeWavsScanBtn">æ‰«ææœªä½¿ç”¨æ–‡ä»¶</button>
                    <button class="btn-danger" id="removeWavsConfirmBtn" style="display: none;">ç¡®è®¤åˆ é™¤</button>
                </div>
            </div>
            <div class="results-container">
                <div class="results-header">
                    <span class="results-title" id="removeWavsResultsTitle">æ‰«æç»“æœ</span>
                    <div class="results-header-actions">
                        <span class="results-count" id="removeWavsCount">0 ä¸ªæ–‡ä»¶</span>
                        <button class="btn-clear" id="removeWavsClearBtn">æ¸…é™¤ç»“æœ</button>
                    </div>
                </div>
                <div class="results-table">
                    <table>
                        <thead>
                            <tr>
                                <th id="removeWavsThIndex">åºå·</th>
                                <th id="removeWavsThPath">æ–‡ä»¶è·¯å¾„</th>
                                <th id="removeWavsThSize">æ–‡ä»¶å¤§å°</th>
                                <th id="removeWavsThMtime">æœ€åä¿®æ”¹æ—¶é—´</th>
                            </tr>
                        </thead>
                        <tbody id="removeWavsBody">
                            <tr>
                                <td colspan="4" class="empty-state" id="removeWavsEmptyState">è¯·ç‚¹å‡»"æ‰«ææœªä½¿ç”¨æ–‡ä»¶"æŒ‰é’®</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <script src="i18n.js"></script>
    <script>
        const { ipcRenderer } = require('electron');
        
        // ä¸»é¢˜å’Œè¯­è¨€ç®¡ç†
        let currentTheme = localStorage.getItem('theme') || 'light';
        let currentLanguage = localStorage.getItem('language') || 'zh';
        
        // æ›´æ–°æ‰€æœ‰æ–‡æœ¬çš„å›½é™…åŒ–
        function updateAllTexts() {
            if (typeof t !== 'function') return;
            
            // æ›´æ–°æ ‡é¢˜
            const titleEl = document.querySelector('h1');
            if (titleEl) titleEl.textContent = t('title');
            document.title = t('title');
            
            // æ›´æ–°ç«¯å£æ ‡ç­¾
            const portLabel = document.querySelector('.input-group label');
            if (portLabel) portLabel.textContent = t('port') + ':';
            
            // æ›´æ–°æ ‡ç­¾é¡µ
            const tabs = document.querySelectorAll('.tab');
            tabs.forEach((tab, index) => {
                const tabKeys = ['tabs.audioRecording', 'tabs.resetFaders', 'tabs.deleteEvents', 'tabs.setStreaming', 'tabs.removeWavs'];
                if (tabKeys[index]) {
                    tab.textContent = t(tabKeys[index]);
                }
            });
            
            // æ›´æ–°çŠ¶æ€æ–‡æœ¬
            updateStatusText();
            
            // æ›´æ–°å„ä¸ªåŠŸèƒ½æ¨¡å—çš„æ–‡æœ¬
            updateAudioRecordingTexts();
            updateResetFadersTexts();
            updateDeleteEventsTexts();
            updateSetStreamingTexts();
            updateRemoveWavsTexts();
        }
        
        // æ›´æ–°éŸ³é¢‘å½•åˆ¶ç›¸å…³æ–‡æœ¬
        function updateAudioRecordingTexts() {
            if (typeof t !== 'function') return;
            const infoBox = document.getElementById('audioRecordingInfoBox');
            if (infoBox) infoBox.textContent = t('audioRecording.info');
            
            const selectPathBtn = document.getElementById('selectRecordingPathBtn');
            if (selectPathBtn) selectPathBtn.textContent = t('audioRecording.selectPathBtn');
            
            const recordingModeLabel = document.getElementById('recordingModeLabel');
            if (recordingModeLabel) recordingModeLabel.textContent = t('audioRecording.recordingModeLabel');
            
            const recordingModeAuto = document.getElementById('recordingModeAuto');
            if (recordingModeAuto) recordingModeAuto.textContent = t('audioRecording.recordingModeAuto');
            
            const recordingModeManual = document.getElementById('recordingModeManual');
            if (recordingModeManual) recordingModeManual.textContent = t('audioRecording.recordingModeManual');
            
            const recordingDurationLabel = document.getElementById('recordingDurationLabel');
            if (recordingDurationLabel) recordingDurationLabel.textContent = t('audioRecording.recordingDurationLabel');
            
            const recordingDurationUnit = document.getElementById('recordingDurationUnit');
            if (recordingDurationUnit) recordingDurationUnit.textContent = t('audioRecording.recordingDurationUnit');
            
            const startBtn = document.getElementById('startRecordingBtn');
            if (startBtn && !startBtn.disabled && !startBtn.textContent.includes('...')) startBtn.textContent = t('audioRecording.startBtn');
            
            const stopBtn = document.getElementById('stopRecordingBtn');
            if (stopBtn && !stopBtn.disabled && !stopBtn.textContent.includes('...')) stopBtn.textContent = t('audioRecording.stopBtn');
            
            // æ›´æ–°æ¨¡å¼æç¤º
            const recordingModeHint = document.getElementById('recordingModeHint');
            if (recordingModeHint) {
                const selectedMode = document.querySelector('input[name="recordingMode"]:checked');
                if (selectedMode && selectedMode.value === 'manual') {
                    recordingModeHint.textContent = t('audioRecording.manualModeHint');
                } else {
                    recordingModeHint.textContent = t('audioRecording.autoModeHint');
                }
            }
            
            // æ›´æ–°è·¯å¾„å¸®åŠ©æ–‡æœ¬
            const pathHelpTitle = document.getElementById('recordingPathHelpTitle');
            if (pathHelpTitle) pathHelpTitle.textContent = t('audioRecording.pathHelpTitle');
            const pathHelp1 = document.getElementById('recordingPathHelp1');
            if (pathHelp1) pathHelp1.textContent = t('audioRecording.pathHelp1');
            const pathHelp2 = document.getElementById('recordingPathHelp2');
            if (pathHelp2) pathHelp2.textContent = t('audioRecording.pathHelp2');
            const pathHelp3 = document.getElementById('recordingPathHelp3');
            if (pathHelp3) pathHelp3.textContent = t('audioRecording.pathHelp3');
            const pathHelp4 = document.getElementById('recordingPathHelp4');
            if (pathHelp4) pathHelp4.textContent = t('audioRecording.pathHelp4');
            const pathHelpNote = document.getElementById('recordingPathHelpNote');
            if (pathHelpNote) pathHelpNote.textContent = t('audioRecording.pathHelpNote');
            
            // æ›´æ–°ç©ºçŠ¶æ€æ–‡æœ¬
            const emptyState = document.getElementById('recordingEmptyState');
            if (emptyState && (!recordedFiles || recordedFiles.length === 0)) {
                emptyState.textContent = typeof t === 'function' ? t('audioRecording.emptyState') : 'è¯·ç‚¹å‡»"å¼€å§‹å½•åˆ¶"æŒ‰é’®';
            }
            
            // æ›´æ–°è·¯å¾„è¾“å…¥æ¡†å ä½ç¬¦
            const pathInput = document.getElementById('recordingPathInput');
            if (pathInput) {
                pathInput.placeholder = typeof t === 'function' ? t('audioRecording.pathPlaceholder') : 'ä» Wwise Recorder æ’ä»¶å¤åˆ¶è·¯å¾„...';
            }
            
            // æ›´æ–°è·¯å¾„æ ‡ç­¾
            const pathLabel = document.getElementById('recordingPathLabel');
            if (pathLabel) {
                pathLabel.textContent = typeof t === 'function' ? t('audioRecording.pathLabel') : 'å½•åˆ¶è·¯å¾„:';
            }
        }
        
        // æ›´æ–°çŠ¶æ€æ–‡æœ¬
        function updateStatusText() {
            if (typeof t !== 'function') return;
            updateConnectionStatus();
        }
        
        // æ›´æ–°é‡ç½®éŸ³é‡æ¨å­ç›¸å…³æ–‡æœ¬
        function updateResetFadersTexts() {
            if (typeof t !== 'function') return;
            const infoBox = document.querySelector('#reset-faders-tab .info-box');
            if (infoBox) infoBox.textContent = t('resetFaders.info');
            
            const scopeSelected = document.getElementById('resetScopeSelected');
            if (scopeSelected) scopeSelected.textContent = t('resetFaders.scopeSelected');
            
            const scopeChildren = document.getElementById('resetScopeChildren');
            if (scopeChildren) scopeChildren.textContent = t('resetFaders.scopeChildren');
            
            const scanBtn = document.getElementById('resetFadersScanBtn');
            if (scanBtn && !scanBtn.disabled && !scanBtn.textContent.includes('...')) scanBtn.textContent = t('resetFaders.scanBtn');
            
            const confirmBtn = document.getElementById('resetFadersConfirmBtn');
            if (confirmBtn && !confirmBtn.disabled && !confirmBtn.textContent.includes('...')) confirmBtn.textContent = t('resetFaders.confirmBtn');
            
            const resultsTitle = document.getElementById('resetFadersResultsTitle');
            if (resultsTitle) resultsTitle.textContent = t('resetFaders.resultsTitle');
            
            const clearBtn = document.getElementById('resetFadersClearBtn');
            if (clearBtn) clearBtn.textContent = t('resetFaders.clearBtn');
            
            const listViewBtn = document.getElementById('resetFadersListViewBtn');
            if (listViewBtn && !listViewBtn.disabled && !listViewBtn.textContent.includes('...')) {
                listViewBtn.textContent = t('resetFaders.listViewBtn');
            }
            
            // æ›´æ–°è¡¨æ ¼è¡¨å¤´
            const thLocate = document.getElementById('resetFadersThLocate');
            if (thLocate) thLocate.textContent = t('resetFaders.tableHeaders.locate');
            const thIndex = document.getElementById('resetFadersThIndex');
            if (thIndex) thIndex.textContent = t('resetFaders.tableHeaders.index');
            const thName = document.getElementById('resetFadersThName');
            if (thName) thName.textContent = t('resetFaders.tableHeaders.name');
            const thType = document.getElementById('resetFadersThType');
            if (thType) thType.textContent = t('resetFaders.tableHeaders.type');
            const thVolume = document.getElementById('resetFadersThVolume');
            if (thVolume) thVolume.textContent = t('resetFaders.tableHeaders.volume');
            const thStatus = document.getElementById('resetFadersThStatus');
            if (thStatus) thStatus.textContent = t('resetFaders.tableHeaders.status');
            
            // æ›´æ–°ç©ºçŠ¶æ€æ–‡æœ¬
            const emptyState = document.getElementById('resetFadersEmptyState');
            if (emptyState && resetFadersResults && resetFadersResults.length === 0) {
                emptyState.textContent = t('resetFaders.emptyState');
            }
        }
        
        // æ›´æ–°åˆ é™¤æ— æ•ˆEventç›¸å…³æ–‡æœ¬
        function updateDeleteEventsTexts() {
            if (typeof t !== 'function') return;
            const infoBox = document.getElementById('deleteEventsInfoBox');
            if (infoBox) infoBox.textContent = t('deleteEvents.info');
            
            const scanBtn = document.getElementById('deleteEventsScanBtn');
            if (scanBtn && !scanBtn.disabled && !scanBtn.textContent.includes('...')) scanBtn.textContent = t('deleteEvents.scanBtn');
            
            const confirmBtn = document.getElementById('deleteEventsConfirmBtn');
            if (confirmBtn && !confirmBtn.disabled && !confirmBtn.textContent.includes('...')) confirmBtn.textContent = t('deleteEvents.confirmBtn');
            
            const resultsTitle = document.getElementById('deleteEventsResultsTitle');
            if (resultsTitle) resultsTitle.textContent = t('deleteEvents.resultsTitle');
            
            const clearBtn = document.getElementById('deleteEventsClearBtn');
            if (clearBtn) clearBtn.textContent = t('deleteEvents.clearBtn');
            
            // æ›´æ–°è¡¨æ ¼è¡¨å¤´
            const thIndex = document.getElementById('deleteEventsThIndex');
            if (thIndex) thIndex.textContent = t('deleteEvents.tableHeaders.index');
            const thName = document.getElementById('deleteEventsThName');
            if (thName) thName.textContent = t('deleteEvents.tableHeaders.name');
            const thLocate = document.getElementById('deleteEventsThLocate');
            if (thLocate) thLocate.textContent = t('deleteEvents.tableHeaders.locate');
            const thGuid = document.getElementById('deleteEventsThGuid');
            if (thGuid) thGuid.textContent = t('deleteEvents.tableHeaders.guid');
            const thReason = document.getElementById('deleteEventsThReason');
            if (thReason) thReason.textContent = t('deleteEvents.tableHeaders.reason');
            
            const listViewBtn = document.getElementById('deleteEventsListViewBtn');
            if (listViewBtn && !listViewBtn.disabled && !listViewBtn.textContent.includes('...')) {
                listViewBtn.textContent = t('deleteEvents.listViewBtn');
            }
            
            // æ›´æ–°ç©ºçŠ¶æ€æ–‡æœ¬
            const emptyState = document.getElementById('deleteEventsEmptyState');
            if (emptyState && deleteEventsResults && deleteEventsResults.length === 0) {
                emptyState.textContent = t('deleteEvents.emptyState');
            }
        }
        
        // æ›´æ–°è®¾ç½®æµæ’­æ”¾ç›¸å…³æ–‡æœ¬
        function updateSetStreamingTexts() {
            if (typeof t !== 'function') return;
            const infoBox = document.getElementById('setStreamingInfoBox');
            if (infoBox) infoBox.textContent = t('setStreaming.info');
            
            const thresholdLabel = document.getElementById('setStreamingThresholdLabel');
            if (thresholdLabel) thresholdLabel.textContent = t('setStreaming.thresholdLabel');
            
            const scanBtn = document.getElementById('setStreamingScanBtn');
            if (scanBtn && !scanBtn.disabled && !scanBtn.textContent.includes('...')) scanBtn.textContent = t('setStreaming.scanBtn');
            
            const confirmBtn = document.getElementById('setStreamingConfirmBtn');
            if (confirmBtn && !confirmBtn.disabled && !confirmBtn.textContent.includes('...')) confirmBtn.textContent = t('setStreaming.confirmBtn');
            
            const resultsTitle = document.getElementById('setStreamingResultsTitle');
            if (resultsTitle) resultsTitle.textContent = t('setStreaming.resultsTitle');
            
            const clearBtn = document.getElementById('setStreamingClearBtn');
            if (clearBtn) clearBtn.textContent = t('setStreaming.clearBtn');
            
            // æ›´æ–°è¡¨æ ¼è¡¨å¤´
            const thIndex = document.getElementById('setStreamingThIndex');
            if (thIndex) thIndex.textContent = t('setStreaming.tableHeaders.index');
            const thName = document.getElementById('setStreamingThName');
            if (thName) thName.textContent = t('setStreaming.tableHeaders.name');
            const thDuration = document.getElementById('setStreamingThDuration');
            if (thDuration) thDuration.textContent = t('setStreaming.tableHeaders.duration');
            const thShouldSet = document.getElementById('setStreamingThShouldSet');
            if (thShouldSet) thShouldSet.textContent = t('setStreaming.tableHeaders.shouldSet');
            const thStatus = document.getElementById('setStreamingThStatus');
            if (thStatus) thStatus.textContent = t('setStreaming.tableHeaders.currentStatus');
            const thLocate = document.getElementById('setStreamingThLocate');
            if (thLocate) thLocate.textContent = t('setStreaming.tableHeaders.locate');
            
            const listViewBtn = document.getElementById('setStreamingListViewBtn');
            if (listViewBtn && !listViewBtn.disabled && !listViewBtn.textContent.includes('...')) {
                listViewBtn.textContent = t('setStreaming.listViewBtn');
            }
            
            const multiEditorBtn = document.getElementById('setStreamingMultiEditorBtn');
            if (multiEditorBtn && !multiEditorBtn.disabled && !multiEditorBtn.textContent.includes('...')) {
                multiEditorBtn.textContent = t('setStreaming.multiEditorBtn');
            }
            
            // æ›´æ–°ç©ºçŠ¶æ€æ–‡æœ¬
            const emptyState = document.getElementById('setStreamingEmptyState');
            if (emptyState && setStreamingResults && setStreamingResults.length === 0) {
                emptyState.textContent = t('setStreaming.emptyState');
            }
        }
        
        // æ›´æ–°åˆ é™¤æœªä½¿ç”¨WAVç›¸å…³æ–‡æœ¬
        function updateRemoveWavsTexts() {
            if (typeof t !== 'function') return;
            const infoBox = document.getElementById('removeWavsInfoBox');
            if (infoBox) infoBox.textContent = t('removeWavs.info');
            
            const selectBtn = document.getElementById('selectOriginalsBtn');
            if (selectBtn) selectBtn.textContent = t('removeWavs.selectBtn');
            
            const scanBtn = document.getElementById('removeWavsScanBtn');
            if (scanBtn && !scanBtn.disabled && !scanBtn.textContent.includes('...')) scanBtn.textContent = t('removeWavs.scanBtn');
            
            const confirmBtn = document.getElementById('removeWavsConfirmBtn');
            if (confirmBtn && !confirmBtn.disabled && !confirmBtn.textContent.includes('...')) confirmBtn.textContent = t('removeWavs.confirmBtn');
            
            const resultsTitle = document.getElementById('removeWavsResultsTitle');
            if (resultsTitle) resultsTitle.textContent = t('removeWavs.resultsTitle');
            
            const clearBtn = document.getElementById('removeWavsClearBtn');
            if (clearBtn) clearBtn.textContent = t('removeWavs.clearBtn');
            
            const pathDisplay = document.getElementById('originalsPath');
            if (pathDisplay && !originalsPath) {
                pathDisplay.textContent = t('removeWavs.pathPlaceholder');
            }
            
            // æ›´æ–°è¡¨æ ¼è¡¨å¤´
            const thIndex = document.getElementById('removeWavsThIndex');
            if (thIndex) thIndex.textContent = t('removeWavs.tableHeaders.index');
            const thPath = document.getElementById('removeWavsThPath');
            if (thPath) thPath.textContent = t('removeWavs.tableHeaders.path');
            const thSize = document.getElementById('removeWavsThSize');
            if (thSize) thSize.textContent = t('removeWavs.tableHeaders.size');
            const thMtime = document.getElementById('removeWavsThMtime');
            if (thMtime) thMtime.textContent = t('removeWavs.tableHeaders.mtime');
            
            // æ›´æ–°ç©ºçŠ¶æ€æ–‡æœ¬
            const emptyState = document.getElementById('removeWavsEmptyState');
            if (emptyState && removeWavsResults && removeWavsResults.length === 0) {
                emptyState.textContent = t('removeWavs.emptyState');
            }
        }
        
        // åˆå§‹åŒ–ä¸»é¢˜
        function initTheme() {
            document.documentElement.setAttribute('data-theme', currentTheme);
            const themeBtn = document.getElementById('themeToggleBtn');
            if (themeBtn) {
                themeBtn.textContent = currentTheme === 'light' ? 'â˜€ï¸' : 'ğŸŒ™';
            }
        }
        
        // åˆå§‹åŒ–è¯­è¨€
        function initLanguage() {
            if (typeof setLanguage === 'function') {
                setLanguage(currentLanguage);
            }
            const langBtn = document.getElementById('langToggleBtn');
            if (langBtn) {
                langBtn.textContent = currentLanguage === 'zh' ? 'ä¸­' : 'E';
            }
            updateAllTexts();
        }
        
        // åˆå§‹åŒ–æŒ‰é’®äº‹ä»¶ç›‘å¬å™¨
        function initButtons() {
            const themeBtn = document.getElementById('themeToggleBtn');
            const langBtn = document.getElementById('langToggleBtn');
            
            if (themeBtn) {
                themeBtn.addEventListener('click', () => {
                    currentTheme = currentTheme === 'light' ? 'dark' : 'light';
                    localStorage.setItem('theme', currentTheme);
                    initTheme();
                });
            }
            
            if (langBtn) {
                langBtn.addEventListener('click', () => {
                    currentLanguage = currentLanguage === 'zh' ? 'en' : 'zh';
                    localStorage.setItem('language', currentLanguage);
                    initLanguage();
                });
            }
        }
        
        // ç­‰å¾…DOMåŠ è½½å®Œæˆåå†åˆå§‹åŒ–
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', () => {
                initTheme();
                initLanguage();
                initButtons();
            });
        } else {
            initTheme();
            initLanguage();
            initButtons();
        }

        // æ ‡ç­¾é¡µåˆ‡æ¢
        document.querySelectorAll('.tab').forEach(tab => {
            tab.addEventListener('click', () => {
                const targetTab = tab.getAttribute('data-tab');
                
                document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
                document.querySelectorAll('.tab-content').forEach(tc => tc.classList.remove('active'));
                
                tab.classList.add('active');
                document.getElementById(targetTab + '-tab').classList.add('active');
            });
        });

        // è¿æ¥çŠ¶æ€
        let isConnected = false;
        let currentProjectName = '';
        let currentWwiseVersion = '';
        const portInput = document.getElementById('portInput');
        const statusIndicator = document.getElementById('statusIndicator');
        const statusText = document.getElementById('statusText');

        // æµ‹è¯•è¿æ¥
        async function testConnection() {
            const port = parseInt(portInput.value) || 8080;
            try {
                const result = await ipcRenderer.invoke('waapi-test-connection', port);
                if (result.success) {
                    isConnected = true;
                    currentProjectName = result.projectName || 'Wwise';
                    currentWwiseVersion = result.wwiseVersion || '';
                    statusIndicator.className = 'status-indicator connected';
                    updateConnectionStatus();
                } else {
                    isConnected = false;
                    currentProjectName = '';
                    currentWwiseVersion = '';
                    statusIndicator.className = 'status-indicator disconnected';
                    statusText.textContent = typeof t === 'function' ? t('disconnected') : 'æœªè¿æ¥';
                }
            } catch (error) {
                isConnected = false;
                currentProjectName = '';
                currentWwiseVersion = '';
                statusIndicator.className = 'status-indicator disconnected';
                statusText.textContent = typeof t === 'function' ? t('disconnected') : 'æœªè¿æ¥';
            }
        }

        // æ›´æ–°è¿æ¥çŠ¶æ€æ˜¾ç¤º
        function updateConnectionStatus() {
            if (isConnected) {
                const connectedText = typeof t === 'function' ? t('connected') : 'å·²è¿æ¥';
                if (currentWwiseVersion) {
                    statusText.textContent = `${connectedText} - ${currentProjectName} (${currentWwiseVersion})`;
                } else {
                    statusText.textContent = `${connectedText} - ${currentProjectName}`;
                }
            } else {
                statusText.textContent = typeof t === 'function' ? t('disconnected') : 'æœªè¿æ¥';
            }
            updateReconnectButtonText();
        }

        // é‡æ–°è¿æ¥æŒ‰é’®
        const reconnectBtn = document.getElementById('reconnectBtn');
        
        // æ›´æ–°è¿æ¥æŒ‰é’®æ–‡æœ¬
        function updateReconnectButtonText() {
            if (typeof t === 'function') {
                reconnectBtn.textContent = isConnected ? t('reconnect') : t('connect');
            } else {
                reconnectBtn.textContent = isConnected ? 'é‡æ–°è¿æ¥' : 'è¿æ¥';
            }
        }

        // é‡æ–°è¿æ¥æŒ‰é’®ç‚¹å‡»äº‹ä»¶
        reconnectBtn.addEventListener('click', async () => {
            reconnectBtn.disabled = true;
            const originalText = reconnectBtn.textContent;
            if (typeof t === 'function') {
                reconnectBtn.textContent = t('connecting') || 'è¿æ¥ä¸­...';
            } else {
                reconnectBtn.textContent = 'è¿æ¥ä¸­...';
            }
            
            await testConnection();
            updateReconnectButtonText();
            reconnectBtn.disabled = false;
        });

        // é¡µé¢åŠ è½½æ—¶æµ‹è¯•è¿æ¥
        testConnection();
        updateReconnectButtonText();
        
        // ç«¯å£è¾“å…¥æ¡†å¤±å»ç„¦ç‚¹æ—¶è‡ªåŠ¨è¿æ¥ï¼ˆå¯é€‰ï¼Œä¹Ÿå¯ä»¥ç§»é™¤è¿™è¡Œè®©ç”¨æˆ·æ‰‹åŠ¨ç‚¹å‡»æŒ‰é’®ï¼‰
        // portInput.addEventListener('change', testConnection);

        // é‡ç½®éŸ³é‡æ¨å­åŠŸèƒ½
        let resetFadersResults = [];
        const resetFadersScanBtn = document.getElementById('resetFadersScanBtn');
        const resetFadersConfirmBtn = document.getElementById('resetFadersConfirmBtn');
        const resetFadersClearBtn = document.getElementById('resetFadersClearBtn');
        const resetFadersBody = document.getElementById('resetFadersBody');
        const resetFadersCount = document.getElementById('resetFadersCount');

        resetFadersScanBtn.addEventListener('click', async () => {
            if (!isConnected) {
                alert(typeof t === 'function' ? t('resetFaders.alertNotConnected') : 'è¯·å…ˆè¿æ¥åˆ°Wwise');
                return;
            }
            const port = parseInt(portInput.value) || 8080;
            const checkedScopes = Array.from(document.querySelectorAll('input[name="resetScope"]:checked')).map(cb => cb.value);
            if (checkedScopes.length === 0) {
                alert('è¯·è‡³å°‘é€‰æ‹©ä¸€ä¸ªé€‰é¡¹');
                return;
            }
            const scope = checkedScopes;
            
            resetFadersScanBtn.disabled = true;
            resetFadersScanBtn.textContent = typeof t === 'function' ? t('resetFaders.scanBtnScanning') : 'æ£€æµ‹ä¸­...';
            
            try {
                const result = await ipcRenderer.invoke('waapi-reset-faders-scan', port, scope);
                resetFadersResults = result.results || [];
                updateResetFadersTable();
                
                // æ˜¾ç¤ºæ£€æµ‹ç»“æœæç¤º
                const countText = typeof t === 'function' ? t('resetFaders.resultsCount') : 'ä¸ªå¯¹è±¡';
                alert((typeof t === 'function' ? t('resetFaders.scanSuccess') : 'æ£€æµ‹å®Œæˆ') + `ï¼šæ‰¾åˆ° ${resetFadersResults.length} ${countText}`);
                
                // æ£€æŸ¥æ˜¯å¦æœ‰æœªå½’é›¶å¯¹è±¡
                const hasNonZero = resetFadersResults.some(item => {
                    const status = item.status || '';
                    if (status === 'å·²å½’é›¶') return false;
                    return item.originalVolume !== null && item.originalVolume !== undefined && item.originalVolume !== 0;
                });
                if (hasNonZero) {
                    resetFadersConfirmBtn.style.display = 'inline-block';
                } else {
                    resetFadersConfirmBtn.style.display = 'none';
                }
            } catch (error) {
                alert((typeof t === 'function' ? t('resetFaders.alertScanFailed') : 'æ£€æµ‹å¤±è´¥') + ': ' + error.message);
            } finally {
                resetFadersScanBtn.disabled = false;
                resetFadersScanBtn.textContent = typeof t === 'function' ? t('resetFaders.scanBtn') : 'å¼€å§‹æ£€æµ‹';
            }
        });

        resetFadersConfirmBtn.addEventListener('click', async () => {
            if (resetFadersResults.length === 0) return;
            
            // è·å–æœªå½’é›¶å¯¹è±¡
            const nonZeroObjects = resetFadersResults.filter(item => {
                const status = item.status || '';
                if (status === 'å·²å½’é›¶') {
                    return false;
                }
                return item.originalVolume !== null && item.originalVolume !== undefined && item.originalVolume !== 0;
            });
            
            if (nonZeroObjects.length === 0) {
                alert(typeof t === 'function' ? t('resetFaders.allZeroed') : 'æ‰€æœ‰å¯¹è±¡å·²å½’é›¶ï¼Œæ— éœ€é‡ç½®');
                return;
            }
            
            const confirmed = await ipcRenderer.invoke('waapi-show-confirm', {
                type: 'warning',
                title: typeof t === 'function' ? t('resetFaders.confirmTitle') : 'ç¡®è®¤é‡ç½®',
                message: typeof t === 'function' ? t('resetFaders.confirmMessage', { count: nonZeroObjects.length }) : `ç¡®å®šè¦é‡ç½® ${nonZeroObjects.length} ä¸ªå¯¹è±¡çš„éŸ³é‡æ¨å­å—ï¼Ÿ`,
                buttons: typeof t === 'function' ? [t('common.cancel'), t('resetFaders.confirmBtn')] : ['å–æ¶ˆ', 'ç¡®è®¤é‡ç½®'],
                defaultId: 1
            });
            
            if (confirmed.response === 1) {
                const port = parseInt(portInput.value) || 8080;
                const checkedScopes = Array.from(document.querySelectorAll('input[name="resetScope"]:checked')).map(cb => cb.value);
                const scope = checkedScopes;
                
                resetFadersConfirmBtn.disabled = true;
                resetFadersConfirmBtn.textContent = typeof t === 'function' ? t('resetFaders.confirmBtnResetting') : 'é‡ç½®ä¸­...';
                
                try {
                    // åªä¼ é€’æœªå½’é›¶å¯¹è±¡è¿›è¡Œé‡ç½®
                    const result = await ipcRenderer.invoke('waapi-reset-faders-execute', port, scope, nonZeroObjects);
                    if (result.success) {
                        // æ›´æ–°æˆåŠŸé‡ç½®çš„å¯¹è±¡çŠ¶æ€ä¸º"å·²é‡ç½®"
                        if (result.resetIds && result.resetIds.length > 0) {
                            const resetIdsSet = new Set(result.resetIds);
                            resetFadersResults.forEach(item => {
                                if (resetIdsSet.has(item.id)) {
                                    item.status = 'å·²é‡ç½®';
                                }
                            });
                        }
                        updateResetFadersTable();
                        alert(typeof t === 'function' ? t('resetFaders.successMessage', { count: result.count }) : `æˆåŠŸé‡ç½® ${result.count} ä¸ªå¯¹è±¡çš„éŸ³é‡æ¨å­`);
                        // æ£€æŸ¥æ˜¯å¦è¿˜æœ‰å¾…é‡ç½®çš„å¯¹è±¡
                        const hasPending = resetFadersResults.some(item => {
                            const status = item.status || '';
                            if (status === 'å·²å½’é›¶') return false;
                            return item.originalVolume !== null && item.originalVolume !== undefined && item.originalVolume !== 0;
                        });
                        if (!hasPending) {
                            resetFadersConfirmBtn.style.display = 'none';
                        }
                    } else {
                        alert((typeof t === 'function' ? t('resetFaders.alertResetFailed') : 'é‡ç½®å¤±è´¥') + ': ' + result.message);
                    }
                } catch (error) {
                    alert((typeof t === 'function' ? t('resetFaders.alertResetFailed') : 'é‡ç½®å¤±è´¥') + ': ' + error.message);
                } finally {
                    resetFadersConfirmBtn.disabled = false;
                    resetFadersConfirmBtn.textContent = typeof t === 'function' ? t('resetFaders.confirmBtn') : 'ç¡®è®¤é‡ç½®';
                }
            }
        });

        resetFadersClearBtn.addEventListener('click', () => {
            resetFadersResults = [];
            updateResetFadersTable();
            resetFadersConfirmBtn.style.display = 'none';
        });

        const resetFadersListViewBtn = document.getElementById('resetFadersListViewBtn');
        resetFadersListViewBtn.addEventListener('click', async () => {
            if (resetFadersResults.length === 0) return;
            if (!isConnected) {
                alert(typeof t === 'function' ? t('resetFaders.alertNotConnected') : 'è¯·å…ˆè¿æ¥åˆ°Wwise');
                return;
            }
            
            // è·å–æœªå½’é›¶å¯¹è±¡
            const nonZeroObjects = resetFadersResults.filter(item => {
                const status = item.status || '';
                if (status === 'å·²å½’é›¶') return false;
                return item.originalVolume !== null && item.originalVolume !== undefined && item.originalVolume !== 0;
            });
            
            if (nonZeroObjects.length === 0) {
                alert(typeof t === 'function' ? t('resetFaders.allZeroed') : 'æ‰€æœ‰å¯¹è±¡å·²å½’é›¶ï¼Œæ— éœ€é‡ç½®');
                return;
            }
            
            const port = parseInt(portInput.value) || 8080;
            resetFadersListViewBtn.disabled = true;
            resetFadersListViewBtn.textContent = typeof t === 'function' ? t('resetFaders.listViewBtnLoading') : 'æ˜¾ç¤ºä¸­...';
            
            try {
                // æå–æœªå½’é›¶å¯¹è±¡çš„ID
                const objectIds = nonZeroObjects
                    .map(r => r.id || r.guid)
                    .filter(id => id && typeof id === 'string');
                
                if (objectIds.length === 0) {
                    alert(typeof t === 'function' ? t('resetFaders.listViewNoObjects') : 'æ²¡æœ‰æœ‰æ•ˆçš„å¯¹è±¡ID');
                    return;
                }
                
                // æ˜¾ç¤ºåˆ°List View
                const result = await ipcRenderer.invoke('waapi-show-list-view', port, objectIds);
                
                if (result.success) {
                    // æˆåŠŸæç¤ºï¼ˆå¯é€‰ï¼‰
                    // alert(typeof t === 'function' ? t('resetFaders.listViewSuccess') : 'å·²æ˜¾ç¤ºåˆ°List View');
                } else {
                    alert((typeof t === 'function' ? t('resetFaders.listViewFailed') : 'æ˜¾ç¤ºåˆ°List Viewå¤±è´¥') + ': ' + result.message);
                }
            } catch (error) {
                alert((typeof t === 'function' ? t('resetFaders.listViewFailed') : 'æ˜¾ç¤ºåˆ°List Viewå¤±è´¥') + ': ' + error.message);
            } finally {
                resetFadersListViewBtn.disabled = false;
                resetFadersListViewBtn.textContent = typeof t === 'function' ? t('resetFaders.listViewBtn') : 'æ˜¾ç¤ºåˆ°List View';
            }
        });

        const resetFadersMultiEditorBtn = document.getElementById('resetFadersMultiEditorBtn');
        resetFadersMultiEditorBtn.addEventListener('click', async () => {
            if (resetFadersResults.length === 0) return;
            if (!isConnected) {
                alert(typeof t === 'function' ? t('resetFaders.alertNotConnected') : 'è¯·å…ˆè¿æ¥åˆ°Wwise');
                return;
            }
            
            // è·å–æœªå½’é›¶å¯¹è±¡
            const nonZeroObjects = resetFadersResults.filter(item => {
                const status = item.status || '';
                if (status === 'å·²å½’é›¶') return false;
                return item.originalVolume !== null && item.originalVolume !== undefined && item.originalVolume !== 0;
            });
            
            if (nonZeroObjects.length === 0) {
                alert(typeof t === 'function' ? t('resetFaders.allZeroed') : 'æ‰€æœ‰å¯¹è±¡å·²å½’é›¶ï¼Œæ— éœ€é‡ç½®');
                return;
            }
            
            const port = parseInt(portInput.value) || 8080;
            resetFadersMultiEditorBtn.disabled = true;
            resetFadersMultiEditorBtn.textContent = typeof t === 'function' ? t('resetFaders.multiEditorBtnLoading') : 'æ˜¾ç¤ºä¸­...';
            
            try {
                // æå–æœªå½’é›¶å¯¹è±¡çš„ID
                const objectIds = nonZeroObjects
                    .map(r => r.id || r.guid)
                    .filter(id => id && typeof id === 'string');
                
                if (objectIds.length === 0) {
                    alert(typeof t === 'function' ? t('resetFaders.multiEditorNoObjects') : 'æ²¡æœ‰æœ‰æ•ˆçš„å¯¹è±¡ID');
                    return;
                }
                
                // æ˜¾ç¤ºåˆ°Multi Editor
                const result = await ipcRenderer.invoke('waapi-show-multi-editor', port, objectIds);
                
                if (result.success) {
                    // æˆåŠŸæç¤ºï¼ˆå¯é€‰ï¼‰
                } else {
                    alert((typeof t === 'function' ? t('resetFaders.multiEditorFailed') : 'æ˜¾ç¤ºåˆ°Multi Editorå¤±è´¥') + ': ' + result.message);
                }
            } catch (error) {
                alert((typeof t === 'function' ? t('resetFaders.multiEditorFailed') : 'æ˜¾ç¤ºåˆ°Multi Editorå¤±è´¥') + ': ' + error.message);
            } finally {
                resetFadersMultiEditorBtn.disabled = false;
                resetFadersMultiEditorBtn.textContent = typeof t === 'function' ? t('resetFaders.multiEditorBtn') : 'æ˜¾ç¤ºåˆ°Multi Editor';
            }
        });

        // åœ¨è¡¨æ ¼æ›´æ–°åé‡æ–°åˆå§‹åŒ–åˆ—å®½è°ƒæ•´
        function updateResetFadersTable() {
            // ç»Ÿè®¡æœªå½’é›¶å¯¹è±¡ï¼ˆçŠ¶æ€ä¸º"å¾…é‡ç½®"æˆ–éŸ³é‡ä¸ä¸º0çš„å¯¹è±¡ï¼‰
            const nonZeroObjects = resetFadersResults.filter(item => {
                const status = item.status || '';
                // å¦‚æœçŠ¶æ€æ˜¯"å·²å½’é›¶"ï¼Œåˆ™ä¸æ˜¯æœªå½’é›¶å¯¹è±¡
                if (status === 'å·²å½’é›¶') {
                    return false;
                }
                // å…¶ä»–æƒ…å†µï¼ˆå¾…é‡ç½®ã€å·²é‡ç½®ç­‰ï¼‰æˆ–è€…éŸ³é‡ä¸ä¸º0çš„éƒ½æ˜¯æœªå½’é›¶å¯¹è±¡
                return item.originalVolume !== null && item.originalVolume !== undefined && item.originalVolume !== 0;
            });
            
            // åªæ˜¾ç¤ºæœªå½’é›¶å¯¹è±¡çš„æ•°é‡
            const countText = typeof t === 'function' ? t('resetFaders.resultsCount') : 'ä¸ªå¯¹è±¡';
            resetFadersCount.textContent = `${nonZeroObjects.length} ${countText}`;
            resetFadersClearBtn.disabled = resetFadersResults.length === 0;
            
            // éšè—æœªå½’é›¶å¯¹è±¡åˆ—è¡¨åŒºåŸŸï¼ˆå› ä¸ºè¡¨æ ¼å·²ç»æ˜¾ç¤ºäº†ï¼‰
            const nonZeroCount = document.getElementById('resetFadersNonZeroCount');
            const nonZeroList = document.getElementById('resetFadersNonZeroList');
            if (nonZeroCount) nonZeroCount.style.display = 'none';
            if (nonZeroList) nonZeroList.style.display = 'none';
            
            // åŸºäºæœªå½’é›¶å¯¹è±¡æ•°é‡æ˜¾ç¤ºæŒ‰é’®
            if (nonZeroObjects.length > 0) {
                resetFadersListViewBtn.style.display = 'inline-block';
                resetFadersMultiEditorBtn.style.display = 'inline-block';
            } else {
                resetFadersListViewBtn.style.display = 'none';
                resetFadersMultiEditorBtn.style.display = 'none';
            }
            
            // å¦‚æœæ²¡æœ‰æ£€æµ‹ç»“æœï¼Œæ˜¾ç¤ºç©ºçŠ¶æ€
            if (resetFadersResults.length === 0) {
                const emptyText = typeof t === 'function' ? t('resetFaders.emptyState') : 'è¯·ç‚¹å‡»"å¼€å§‹æ£€æµ‹"æŒ‰é’®';
                resetFadersBody.innerHTML = `<tr><td colspan="6" class="empty-state" id="resetFadersEmptyState">${emptyText}</td></tr>`;
                return;
            }
            
            // å¦‚æœæ²¡æœ‰æœªå½’é›¶å¯¹è±¡ï¼Œæ˜¾ç¤ºæç¤ºä¿¡æ¯
            if (nonZeroObjects.length === 0) {
                const emptyText = typeof t === 'function' ? t('resetFaders.allZeroed') : 'æ‰€æœ‰å¯¹è±¡å·²å½’é›¶ï¼Œæ— éœ€é‡ç½®';
                resetFadersBody.innerHTML = `<tr><td colspan="6" class="empty-state" id="resetFadersEmptyState">${emptyText}</td></tr>`;
                return;
            }
            
            // åªæ˜¾ç¤ºæœªå½’é›¶å¯¹è±¡
            resetFadersBody.innerHTML = nonZeroObjects.map((item, index) => `
                <tr>
                    <td><button class="btn-locate" onclick="locateObject('${item.id}')" title="å®šä½"><svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z"/></svg></button></td>
                    <td>${index + 1}</td>
                    <td>${item.name || 'N/A'}</td>
                    <td>${item.type || 'N/A'}</td>
                    <td>${item.originalVolume !== null && item.originalVolume !== undefined ? item.originalVolume.toFixed(2) : 'N/A'}</td>
                    <td>${item.status === 'å·²å½’é›¶' ? (typeof t === 'function' ? t('resetFaders.statusZeroed') : 'å·²å½’é›¶') : (item.status === 'å·²é‡ç½®' ? (typeof t === 'function' ? t('resetFaders.statusReset') : 'å·²é‡ç½®') + ' <span style="color: #4caf50;">âœ“</span>' : (item.status === 'å¾…é‡ç½®' ? (typeof t === 'function' ? t('resetFaders.statusPending') : 'å¾…é‡ç½®') : (item.status || (typeof t === 'function' ? t('resetFaders.statusPending') : 'å¾…é‡ç½®'))))}</td>
                </tr>
            `).join('');
        }

        // å®šä½å¯¹è±¡åˆ°Wwiseçª—å£
        async function locateObject(objectId) {
            if (!isConnected) {
                alert(typeof t === 'function' ? t('resetFaders.alertNotConnected') : 'è¯·å…ˆè¿æ¥åˆ°Wwise');
                return;
            }
            const port = parseInt(portInput.value) || 8080;
            try {
                await ipcRenderer.invoke('waapi-locate-object', port, objectId);
            } catch (error) {
                alert('å®šä½å¤±è´¥: ' + error.message);
            }
        }

        // åˆ é™¤æ— æ•ˆEventåŠŸèƒ½
        let deleteEventsResults = [];
        const deleteEventsScanBtn = document.getElementById('deleteEventsScanBtn');
        const deleteEventsConfirmBtn = document.getElementById('deleteEventsConfirmBtn');
        const deleteEventsClearBtn = document.getElementById('deleteEventsClearBtn');
        const deleteEventsBody = document.getElementById('deleteEventsBody');
        const deleteEventsCount = document.getElementById('deleteEventsCount');

        deleteEventsScanBtn.addEventListener('click', async () => {
            if (!isConnected) {
                alert(typeof t === 'function' ? t('deleteEvents.alertNotConnected') : 'è¯·å…ˆè¿æ¥åˆ°Wwise');
                return;
            }
            const port = parseInt(portInput.value) || 8080;
            
            deleteEventsScanBtn.disabled = true;
            deleteEventsScanBtn.textContent = typeof t === 'function' ? t('deleteEvents.scanBtnScanning') : 'æ‰«æä¸­...';
            
            try {
                const result = await ipcRenderer.invoke('waapi-delete-events-scan', port);
                deleteEventsResults = result.results || [];
                updateDeleteEventsTable();
                
                // æ˜¾ç¤ºæ£€æµ‹ç»“æœæç¤º
                const countText = typeof t === 'function' ? t('deleteEvents.resultsCount') : 'ä¸ªEvent';
                if (deleteEventsResults.length > 0) {
                    alert((typeof t === 'function' ? t('deleteEvents.scanSuccess') : 'æ‰«æå®Œæˆ') + `ï¼šæ‰¾åˆ° ${deleteEventsResults.length} ${countText}`);
                    deleteEventsConfirmBtn.style.display = 'inline-block';
                } else {
                    alert(typeof t === 'function' ? t('deleteEvents.scanNoResults') : 'æ‰«æå®Œæˆï¼šæœªæ‰¾åˆ°æ— æ•ˆEvent');
                }
            } catch (error) {
                alert((typeof t === 'function' ? t('deleteEvents.alertScanFailed') : 'æ‰«æå¤±è´¥') + ': ' + error.message);
            } finally {
                deleteEventsScanBtn.disabled = false;
                deleteEventsScanBtn.textContent = typeof t === 'function' ? t('deleteEvents.scanBtn') : 'æ‰«ææ— æ•ˆEvent';
            }
        });

        deleteEventsConfirmBtn.addEventListener('click', async () => {
            if (deleteEventsResults.length === 0) return;
            
            const confirmed = await ipcRenderer.invoke('waapi-show-confirm', {
                type: 'warning',
                title: typeof t === 'function' ? t('deleteEvents.confirmTitle') : 'ç¡®è®¤åˆ é™¤',
                message: typeof t === 'function' ? t('deleteEvents.confirmMessage', { count: deleteEventsResults.length }) : `ç¡®å®šè¦åˆ é™¤ ${deleteEventsResults.length} ä¸ªæ— æ•ˆEventå—ï¼Ÿæ­¤æ“ä½œä¸å¯æ’¤é”€ï¼`,
                buttons: typeof t === 'function' ? [t('common.cancel'), t('deleteEvents.confirmBtn')] : ['å–æ¶ˆ', 'ç¡®è®¤åˆ é™¤'],
                defaultId: 1
            });
            
            if (confirmed.response === 1) {
                const port = parseInt(portInput.value) || 8080;
                
                deleteEventsConfirmBtn.disabled = true;
                deleteEventsConfirmBtn.textContent = typeof t === 'function' ? t('deleteEvents.confirmBtnDeleting') : 'åˆ é™¤ä¸­...';
                
                try {
                    const result = await ipcRenderer.invoke('waapi-delete-events-execute', port, deleteEventsResults);
                    if (result.success) {
                        alert(typeof t === 'function' ? t('deleteEvents.successMessage', { count: result.count }) : `æˆåŠŸåˆ é™¤ ${result.count} ä¸ªæ— æ•ˆEvent`);
                        deleteEventsResults = [];
                        updateDeleteEventsTable();
                        deleteEventsConfirmBtn.style.display = 'none';
                    } else {
                        alert((typeof t === 'function' ? t('deleteEvents.alertDeleteFailed') : 'åˆ é™¤å¤±è´¥') + ': ' + result.message);
                    }
                } catch (error) {
                    alert((typeof t === 'function' ? t('deleteEvents.alertDeleteFailed') : 'åˆ é™¤å¤±è´¥') + ': ' + error.message);
                } finally {
                    deleteEventsConfirmBtn.disabled = false;
                    deleteEventsConfirmBtn.textContent = typeof t === 'function' ? t('deleteEvents.confirmBtn') : 'ç¡®è®¤åˆ é™¤';
                }
            }
        });

        deleteEventsClearBtn.addEventListener('click', () => {
            deleteEventsResults = [];
            updateDeleteEventsTable();
            deleteEventsConfirmBtn.style.display = 'none';
        });

        const deleteEventsListViewBtn = document.getElementById('deleteEventsListViewBtn');
        deleteEventsListViewBtn.addEventListener('click', async () => {
            if (deleteEventsResults.length === 0) return;
            if (!isConnected) {
                alert(typeof t === 'function' ? t('deleteEvents.alertNotConnected') : 'è¯·å…ˆè¿æ¥åˆ°Wwise');
                return;
            }
            
            const port = parseInt(portInput.value) || 8080;
            deleteEventsListViewBtn.disabled = true;
            deleteEventsListViewBtn.textContent = typeof t === 'function' ? t('deleteEvents.listViewBtnLoading') : 'æ˜¾ç¤ºä¸­...';
            
            try {
                // æå–æ‰€æœ‰å¯¹è±¡ID
                const objectIds = deleteEventsResults
                    .map(r => r.guid || r.id)
                    .filter(id => id && typeof id === 'string');
                
                if (objectIds.length === 0) {
                    alert(typeof t === 'function' ? t('deleteEvents.listViewNoObjects') : 'æ²¡æœ‰æœ‰æ•ˆçš„å¯¹è±¡ID');
                    return;
                }
                
                // æ˜¾ç¤ºåˆ°List View
                const result = await ipcRenderer.invoke('waapi-show-list-view', port, objectIds);
                
                if (result.success) {
                    // æˆåŠŸæç¤ºï¼ˆå¯é€‰ï¼‰
                } else {
                    alert((typeof t === 'function' ? t('deleteEvents.listViewFailed') : 'æ˜¾ç¤ºåˆ°List Viewå¤±è´¥') + ': ' + result.message);
                }
            } catch (error) {
                alert((typeof t === 'function' ? t('deleteEvents.listViewFailed') : 'æ˜¾ç¤ºåˆ°List Viewå¤±è´¥') + ': ' + error.message);
            } finally {
                deleteEventsListViewBtn.disabled = false;
                deleteEventsListViewBtn.textContent = typeof t === 'function' ? t('deleteEvents.listViewBtn') : 'æ˜¾ç¤ºåˆ°List View';
            }
        });

        const deleteEventsMultiEditorBtn = document.getElementById('deleteEventsMultiEditorBtn');
        deleteEventsMultiEditorBtn.addEventListener('click', async () => {
            if (deleteEventsResults.length === 0) return;
            if (!isConnected) {
                alert(typeof t === 'function' ? t('deleteEvents.alertNotConnected') : 'è¯·å…ˆè¿æ¥åˆ°Wwise');
                return;
            }
            
            const port = parseInt(portInput.value) || 8080;
            deleteEventsMultiEditorBtn.disabled = true;
            deleteEventsMultiEditorBtn.textContent = typeof t === 'function' ? t('deleteEvents.multiEditorBtnLoading') : 'æ˜¾ç¤ºä¸­...';
            
            try {
                // æå–æ‰€æœ‰å¯¹è±¡ID
                const objectIds = deleteEventsResults
                    .map(r => r.guid || r.id)
                    .filter(id => id && typeof id === 'string');
                
                if (objectIds.length === 0) {
                    alert(typeof t === 'function' ? t('deleteEvents.multiEditorNoObjects') : 'æ²¡æœ‰æœ‰æ•ˆçš„å¯¹è±¡ID');
                    return;
                }
                
                // æ˜¾ç¤ºåˆ°Multi Editor
                const result = await ipcRenderer.invoke('waapi-show-multi-editor', port, objectIds);
                
                if (result.success) {
                    // æˆåŠŸæç¤ºï¼ˆå¯é€‰ï¼‰
                } else {
                    alert((typeof t === 'function' ? t('deleteEvents.multiEditorFailed') : 'æ˜¾ç¤ºåˆ°Multi Editorå¤±è´¥') + ': ' + result.message);
                }
            } catch (error) {
                alert((typeof t === 'function' ? t('deleteEvents.multiEditorFailed') : 'æ˜¾ç¤ºåˆ°Multi Editorå¤±è´¥') + ': ' + error.message);
            } finally {
                deleteEventsMultiEditorBtn.disabled = false;
                deleteEventsMultiEditorBtn.textContent = typeof t === 'function' ? t('deleteEvents.multiEditorBtn') : 'æ˜¾ç¤ºåˆ°Multi Editor';
            }
        });

        function updateDeleteEventsTable() {
            const countText = typeof t === 'function' ? t('deleteEvents.resultsCount') : 'ä¸ªEvent';
            deleteEventsCount.textContent = `${deleteEventsResults.length} ${countText}`;
            deleteEventsClearBtn.disabled = deleteEventsResults.length === 0;
            if (deleteEventsResults.length > 0) {
                deleteEventsListViewBtn.style.display = 'inline-block';
                deleteEventsMultiEditorBtn.style.display = 'inline-block';
            } else {
                deleteEventsListViewBtn.style.display = 'none';
                deleteEventsMultiEditorBtn.style.display = 'none';
            }
            if (deleteEventsResults.length === 0) {
                const emptyText = typeof t === 'function' ? t('deleteEvents.emptyState') : 'è¯·ç‚¹å‡»"æ‰«ææ— æ•ˆEvent"æŒ‰é’®';
                deleteEventsBody.innerHTML = `<tr><td colspan="5" class="empty-state">${emptyText}</td></tr>`;
                return;
            }
            deleteEventsBody.innerHTML = deleteEventsResults.map((item, index) => `
                <tr>
                    <td><button class="btn-locate" onclick="locateObject('${item.guid}')" title="å®šä½"><svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z"/></svg></button></td>
                    <td>${index + 1}</td>
                    <td>${item.name || 'N/A'}</td>
                    <td>${item.reason || (typeof t === 'function' ? t('deleteEvents.defaultReason') : 'æ‰€æœ‰Actionéƒ½å¼•ç”¨ä¸å­˜åœ¨çš„å¯¹è±¡')}</td>
                    <td style="font-family: monospace; font-size: 12px;">${item.path || item.guid || 'N/A'}</td>
                </tr>
            `).join('');
        }

        // è®¾ç½®æµæ’­æ”¾åŠŸèƒ½
        let setStreamingResults = [];
        const setStreamingScanBtn = document.getElementById('setStreamingScanBtn');
        const setStreamingConfirmBtn = document.getElementById('setStreamingConfirmBtn');
        const setStreamingClearBtn = document.getElementById('setStreamingClearBtn');
        const setStreamingListViewBtn = document.getElementById('setStreamingListViewBtn');
        const setStreamingBody = document.getElementById('setStreamingBody');
        const setStreamingCount = document.getElementById('setStreamingCount');
        const streamingThreshold = document.getElementById('streamingThreshold');

        setStreamingScanBtn.addEventListener('click', async () => {
            if (!isConnected) {
                alert(typeof t === 'function' ? t('setStreaming.alertNotConnected') : 'è¯·å…ˆè¿æ¥åˆ°Wwise');
                return;
            }
            const port = parseInt(portInput.value) || 8080;
            const threshold = parseFloat(streamingThreshold.value) || 10;
            
            setStreamingScanBtn.disabled = true;
            setStreamingScanBtn.textContent = typeof t === 'function' ? t('setStreaming.scanBtnScanning') : 'æ£€æµ‹ä¸­...';
            
            try {
                const result = await ipcRenderer.invoke('waapi-set-streaming-scan', port, threshold);
                setStreamingResults = result.results || [];
                updateSetStreamingTable();
                
                // æ˜¾ç¤ºæ£€æµ‹ç»“æœæç¤º
                const countText = typeof t === 'function' ? t('setStreaming.resultsCount') : 'ä¸ªå¯¹è±¡';
                if (setStreamingResults.length > 0) {
                    alert((typeof t === 'function' ? t('setStreaming.scanSuccess') : 'æ£€æµ‹å®Œæˆ') + `ï¼šæ‰¾åˆ° ${setStreamingResults.length} ${countText}`);
                    setStreamingConfirmBtn.style.display = 'inline-block';
                } else {
                    alert(typeof t === 'function' ? t('setStreaming.scanNoResults') : 'æ£€æµ‹å®Œæˆï¼šæœªæ‰¾åˆ°æ»¡è¶³æ¡ä»¶çš„å¯¹è±¡');
                }
            } catch (error) {
                alert((typeof t === 'function' ? t('setStreaming.alertScanFailed') : 'æ£€æµ‹å¤±è´¥') + ': ' + error.message);
            } finally {
                setStreamingScanBtn.disabled = false;
                setStreamingScanBtn.textContent = typeof t === 'function' ? t('setStreaming.scanBtn') : 'æ£€æµ‹é€‰ä¸­å®¹å™¨';
            }
        });

        setStreamingConfirmBtn.addEventListener('click', async () => {
            if (setStreamingResults.length === 0) return;
            
            const confirmed = await ipcRenderer.invoke('waapi-show-confirm', {
                type: 'info',
                title: typeof t === 'function' ? t('setStreaming.confirmTitle') : 'ç¡®è®¤è®¾ç½®',
                message: typeof t === 'function' ? t('setStreaming.confirmMessage', { count: setStreamingResults.length }) : `ç¡®å®šè¦ä¸º ${setStreamingResults.length} ä¸ªå¯¹è±¡è®¾ç½®æµæ’­æ”¾å—ï¼Ÿ`,
                buttons: typeof t === 'function' ? [t('common.cancel'), t('setStreaming.confirmBtn')] : ['å–æ¶ˆ', 'ç¡®è®¤è®¾ç½®'],
                defaultId: 1
            });
            
            if (confirmed.response === 1) {
                const port = parseInt(portInput.value) || 8080;
                const threshold = parseFloat(streamingThreshold.value) || 10;
                
                setStreamingConfirmBtn.disabled = true;
                setStreamingConfirmBtn.textContent = typeof t === 'function' ? t('setStreaming.confirmBtnSetting') : 'è®¾ç½®ä¸­...';
                
                try {
                    const result = await ipcRenderer.invoke('waapi-set-streaming-execute', port, threshold, setStreamingResults);
                    if (result.success) {
                        alert(typeof t === 'function' ? t('setStreaming.successMessage', { count: result.count }) : `æˆåŠŸä¸º ${result.count} ä¸ªå¯¹è±¡è®¾ç½®æµæ’­æ”¾`);
                        setStreamingResults = [];
                        updateSetStreamingTable();
                        setStreamingConfirmBtn.style.display = 'none';
                    } else {
                        alert((typeof t === 'function' ? t('setStreaming.alertSetFailed') : 'è®¾ç½®å¤±è´¥') + ': ' + result.message);
                    }
                } catch (error) {
                    alert((typeof t === 'function' ? t('setStreaming.alertSetFailed') : 'è®¾ç½®å¤±è´¥') + ': ' + error.message);
                } finally {
                    setStreamingConfirmBtn.disabled = false;
                    setStreamingConfirmBtn.textContent = typeof t === 'function' ? t('setStreaming.confirmBtn') : 'ç¡®è®¤è®¾ç½®';
                }
            }
        });

        setStreamingClearBtn.addEventListener('click', () => {
            setStreamingResults = [];
            updateSetStreamingTable();
            setStreamingConfirmBtn.style.display = 'none';
        });

        setStreamingListViewBtn.addEventListener('click', async () => {
            if (setStreamingResults.length === 0) return;
            if (!isConnected) {
                alert(typeof t === 'function' ? t('setStreaming.alertNotConnected') : 'è¯·å…ˆè¿æ¥åˆ°Wwise');
                return;
            }
            
            const port = parseInt(portInput.value) || 8080;
            setStreamingListViewBtn.disabled = true;
            setStreamingListViewBtn.textContent = typeof t === 'function' ? t('setStreaming.listViewBtnLoading') : 'æ˜¾ç¤ºä¸­...';
            
            try {
                // æå–æ‰€æœ‰å¯¹è±¡ID
                const objectIds = setStreamingResults
                    .map(r => r.id || r.guid)
                    .filter(id => id && typeof id === 'string');
                
                if (objectIds.length === 0) {
                    alert(typeof t === 'function' ? t('setStreaming.listViewNoObjects') : 'æ²¡æœ‰æœ‰æ•ˆçš„å¯¹è±¡ID');
                    return;
                }
                
                // æ˜¾ç¤ºåˆ°List View
                const result = await ipcRenderer.invoke('waapi-show-list-view', port, objectIds);
                
                if (result.success) {
                    // æˆåŠŸæç¤ºï¼ˆå¯é€‰ï¼‰
                } else {
                    alert((typeof t === 'function' ? t('setStreaming.listViewFailed') : 'æ˜¾ç¤ºåˆ°List Viewå¤±è´¥') + ': ' + result.message);
                }
            } catch (error) {
                alert((typeof t === 'function' ? t('setStreaming.listViewFailed') : 'æ˜¾ç¤ºåˆ°List Viewå¤±è´¥') + ': ' + error.message);
            } finally {
                setStreamingListViewBtn.disabled = false;
                setStreamingListViewBtn.textContent = typeof t === 'function' ? t('setStreaming.listViewBtn') : 'æ˜¾ç¤ºåˆ°List View';
            }
        });

        const setStreamingMultiEditorBtn = document.getElementById('setStreamingMultiEditorBtn');
        setStreamingMultiEditorBtn.addEventListener('click', async () => {
            if (setStreamingResults.length === 0) return;
            if (!isConnected) {
                alert(typeof t === 'function' ? t('setStreaming.alertNotConnected') : 'è¯·å…ˆè¿æ¥åˆ°Wwise');
                return;
            }
            
            const port = parseInt(portInput.value) || 8080;
            setStreamingMultiEditorBtn.disabled = true;
            setStreamingMultiEditorBtn.textContent = typeof t === 'function' ? t('setStreaming.multiEditorBtnLoading') : 'æ˜¾ç¤ºä¸­...';
            
            try {
                // æå–æ‰€æœ‰å¯¹è±¡ID
                const objectIds = setStreamingResults
                    .map(r => r.id || r.guid)
                    .filter(id => id && typeof id === 'string');
                
                if (objectIds.length === 0) {
                    alert(typeof t === 'function' ? t('setStreaming.multiEditorNoObjects') : 'æ²¡æœ‰æœ‰æ•ˆçš„å¯¹è±¡ID');
                    return;
                }
                
                // æ˜¾ç¤ºåˆ°Multi Editor
                const result = await ipcRenderer.invoke('waapi-show-multi-editor', port, objectIds);
                
                if (result.success) {
                    // æˆåŠŸæç¤ºï¼ˆå¯é€‰ï¼‰
                } else {
                    alert((typeof t === 'function' ? t('setStreaming.multiEditorFailed') : 'æ˜¾ç¤ºåˆ°Multi Editorå¤±è´¥') + ': ' + result.message);
                }
            } catch (error) {
                alert((typeof t === 'function' ? t('setStreaming.multiEditorFailed') : 'æ˜¾ç¤ºåˆ°Multi Editorå¤±è´¥') + ': ' + error.message);
            } finally {
                setStreamingMultiEditorBtn.disabled = false;
                setStreamingMultiEditorBtn.textContent = typeof t === 'function' ? t('setStreaming.multiEditorBtn') : 'æ˜¾ç¤ºåˆ°Multi Editor';
            }
        });

        function updateSetStreamingTable() {
            const countText = typeof t === 'function' ? t('setStreaming.resultsCount') : 'ä¸ªå¯¹è±¡';
            setStreamingCount.textContent = `${setStreamingResults.length} ${countText}`;
            setStreamingClearBtn.disabled = setStreamingResults.length === 0;
            if (setStreamingResults.length > 0) {
                setStreamingListViewBtn.style.display = 'inline-block';
                setStreamingMultiEditorBtn.style.display = 'inline-block';
            } else {
                setStreamingListViewBtn.style.display = 'none';
                setStreamingMultiEditorBtn.style.display = 'none';
            }
            if (setStreamingResults.length === 0) {
                const emptyText = typeof t === 'function' ? t('setStreaming.emptyState') : 'è¯·ç‚¹å‡»"æ£€æµ‹é€‰ä¸­å®¹å™¨"æŒ‰é’®';
                setStreamingBody.innerHTML = `<tr><td colspan="6" class="empty-state" id="setStreamingEmptyState">${emptyText}</td></tr>`;
                return;
            }
            setStreamingBody.innerHTML = setStreamingResults.map((item, index) => `
                <tr>
                    <td><button class="btn-locate" onclick="locateObject('${item.id}')" title="å®šä½"><svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z"/></svg></button></td>
                    <td>${index + 1}</td>
                    <td>${item.name || 'N/A'}</td>
                    <td>${item.duration !== null && item.duration !== undefined ? item.duration.toFixed(2) : 'N/A'}</td>
                    <td>${item.shouldSet ? (typeof t === 'function' ? t('setStreaming.yes') : 'æ˜¯') : (typeof t === 'function' ? t('setStreaming.no') : 'å¦')}</td>
                    <td>${item.currentStreaming ? (typeof t === 'function' ? t('setStreaming.enabled') : 'å·²å¯ç”¨') : (typeof t === 'function' ? t('setStreaming.disabled') : 'æœªå¯ç”¨')}</td>
                </tr>

                `).join('');
        }

        // åˆ é™¤æœªä½¿ç”¨WAVåŠŸèƒ½
        let removeWavsResults = [];
        let originalsPath = '';
        const selectOriginalsBtn = document.getElementById('selectOriginalsBtn');
        const originalsPathDisplay = document.getElementById('originalsPath');
        const removeWavsScanBtn = document.getElementById('removeWavsScanBtn');
        const removeWavsConfirmBtn = document.getElementById('removeWavsConfirmBtn');
        const removeWavsClearBtn = document.getElementById('removeWavsClearBtn');
        const removeWavsBody = document.getElementById('removeWavsBody');
        const removeWavsCount = document.getElementById('removeWavsCount');

        selectOriginalsBtn.addEventListener('click', async () => {
            const result = await ipcRenderer.invoke('waapi-select-folder');
            if (!result.canceled && result.filePaths && result.filePaths.length > 0) {
                originalsPath = result.filePaths[0];
                originalsPathDisplay.textContent = originalsPath;
            }
        });

        removeWavsScanBtn.addEventListener('click', async () => {
            if (!isConnected) {
                alert(typeof t === 'function' ? t('removeWavs.alertNotConnected') : 'è¯·å…ˆè¿æ¥åˆ°Wwise');
                return;
            }
            if (!originalsPath) {
                alert(typeof t === 'function' ? t('removeWavs.alertNoPath') : 'è¯·å…ˆé€‰æ‹©Originalsæ–‡ä»¶å¤¹');
                return;
            }
            const port = parseInt(portInput.value) || 8080;
            
            removeWavsScanBtn.disabled = true;
            removeWavsScanBtn.textContent = typeof t === 'function' ? t('removeWavs.scanBtnScanning') : 'æ‰«æä¸­...';
            
            try {
                const result = await ipcRenderer.invoke('waapi-remove-wavs-scan', port, originalsPath);
                removeWavsResults = result.results || [];
                updateRemoveWavsTable();
                if (removeWavsResults.length > 0) {
                    removeWavsConfirmBtn.style.display = 'inline-block';
                }
            } catch (error) {
                alert((typeof t === 'function' ? t('removeWavs.alertScanFailed') : 'æ‰«æå¤±è´¥') + ': ' + error.message);
            } finally {
                removeWavsScanBtn.disabled = false;
                removeWavsScanBtn.textContent = typeof t === 'function' ? t('removeWavs.scanBtn') : 'æ‰«ææœªä½¿ç”¨æ–‡ä»¶';
            }
        });

        removeWavsConfirmBtn.addEventListener('click', async () => {
            if (removeWavsResults.length === 0) return;
            
            const totalSize = removeWavsResults.reduce((sum, item) => sum + (item.size || 0), 0);
            const sizeMB = (totalSize / 1024 / 1024).toFixed(2);
            
            const confirmed = await ipcRenderer.invoke('waapi-show-confirm', {
                type: 'warning',
                title: typeof t === 'function' ? t('removeWavs.confirmTitle') : 'ç¡®è®¤åˆ é™¤',
                message: typeof t === 'function' ? t('removeWavs.confirmMessage', { count: removeWavsResults.length, size: sizeMB }) : `ç¡®å®šè¦åˆ é™¤ ${removeWavsResults.length} ä¸ªæœªä½¿ç”¨çš„WAVæ–‡ä»¶å—ï¼Ÿ\næ€»å¤§å°: ${sizeMB} MB\næ­¤æ“ä½œä¸å¯æ’¤é”€ï¼`,
                buttons: typeof t === 'function' ? [t('common.cancel'), t('removeWavs.confirmBtn')] : ['å–æ¶ˆ', 'ç¡®è®¤åˆ é™¤'],
                defaultId: 1
            });
            
            if (confirmed.response === 1) {
                removeWavsConfirmBtn.disabled = true;
                removeWavsConfirmBtn.textContent = typeof t === 'function' ? t('removeWavs.confirmBtnDeleting') : 'åˆ é™¤ä¸­...';
                
                try {
                    const result = await ipcRenderer.invoke('waapi-remove-wavs-execute', removeWavsResults);
                    if (result.success) {
                        alert(typeof t === 'function' ? t('removeWavs.successMessage', { count: result.count }) : `æˆåŠŸåˆ é™¤ ${result.count} ä¸ªæ–‡ä»¶`);
                        removeWavsResults = [];
                        updateRemoveWavsTable();
                        removeWavsConfirmBtn.style.display = 'none';
                    } else {
                        alert((typeof t === 'function' ? t('removeWavs.alertDeleteFailed') : 'åˆ é™¤å¤±è´¥') + ': ' + result.message);
                    }
                } catch (error) {
                    alert((typeof t === 'function' ? t('removeWavs.alertDeleteFailed') : 'åˆ é™¤å¤±è´¥') + ': ' + error.message);
                } finally {
                    removeWavsConfirmBtn.disabled = false;
                    removeWavsConfirmBtn.textContent = typeof t === 'function' ? t('removeWavs.confirmBtn') : 'ç¡®è®¤åˆ é™¤';
                }
            }
        });

        removeWavsClearBtn.addEventListener('click', () => {
            removeWavsResults = [];
            updateRemoveWavsTable();
            removeWavsConfirmBtn.style.display = 'none';
        });

        function updateRemoveWavsTable() {
            const countText = typeof t === 'function' ? t('removeWavs.resultsCount') : 'ä¸ªæ–‡ä»¶';
            removeWavsCount.textContent = `${removeWavsResults.length} ${countText}`;
            removeWavsClearBtn.disabled = removeWavsResults.length === 0;
            if (removeWavsResults.length === 0) {
                const emptyText = typeof t === 'function' ? t('removeWavs.emptyState') : 'è¯·ç‚¹å‡»"æ‰«ææœªä½¿ç”¨æ–‡ä»¶"æŒ‰é’®';
                removeWavsBody.innerHTML = `<tr><td colspan="4" class="empty-state" id="removeWavsEmptyState">${emptyText}</td></tr>`;
                return;
            }
            removeWavsBody.innerHTML = removeWavsResults.map((item, index) => {
                const sizeKB = ((item.size || 0) / 1024).toFixed(2);
                const date = item.mtime ? new Date(item.mtime).toLocaleString('zh-CN') : 'N/A';
                return `
                    <tr>
                        <td>${index + 1}</td>
                        <td style="font-family: monospace; font-size: 12px;">${item.path || 'N/A'}</td>
                        <td>${sizeKB} KB</td>
                        <td>${date}</td>
                    </tr>
                `;
            }).join('');
        }

        // è‡ªåŠ¨è·å–Originalsè·¯å¾„
        (async () => {
            if (isConnected) {
                const port = parseInt(portInput.value) || 8080;
                try {
                    const result = await ipcRenderer.invoke('waapi-get-originals-path', port);
                    if (result.success && result.path) {
                        originalsPath = result.path;
                        originalsPathDisplay.textContent = originalsPath;
                    }
                } catch (error) {
                    // å¿½ç•¥é”™è¯¯ï¼Œç”¨æˆ·å¯ä»¥æ‰‹åŠ¨é€‰æ‹©
                }
            }
        })();

        // éŸ³é¢‘å½•åˆ¶åŠŸèƒ½
        let recordingPath = null;
        let recordingDir = null;
        let recordedFiles = [];
        let isRecording = false;
        const selectRecordingPathBtn = document.getElementById('selectRecordingPathBtn');
        const recordingPathInput = document.getElementById('recordingPathInput');
        const recordingPathHelpBtn = document.getElementById('recordingPathHelpBtn');
        const recordingPathHelpText = document.getElementById('recordingPathHelpText');
        const recordingModeRadios = document.querySelectorAll('input[name="recordingMode"]');
        const recordingModeHint = document.getElementById('recordingModeHint');
        const recordingDurationGroup = document.getElementById('recordingDurationGroup');
        const recordingDurationInput = document.getElementById('recordingDurationInput');
        const startRecordingBtn = document.getElementById('startRecordingBtn');
        const stopRecordingBtn = document.getElementById('stopRecordingBtn');
        const recordingProgressText = document.getElementById('recordingProgressText');
        const recordingProgressBar = document.getElementById('recordingProgressBar');
        const recordingProgressFill = document.getElementById('recordingProgressFill');
        const recordingResultsBody = document.getElementById('recordingResultsBody');
        const openRecordingFolderBtn = document.getElementById('openRecordingFolderBtn');

        // ç›‘å¬è·¯å¾„è¾“å…¥å˜åŒ–
        recordingPathInput.addEventListener('input', () => {
            const path = recordingPathInput.value.trim();
            recordingPath = path || null;
            if (path) {
                if (!path.endsWith('Record.wav')) {
                    recordingPathInput.style.borderColor = '#ffc107';
                } else {
                    recordingPathInput.style.borderColor = '#28a745';
                }
            } else {
                recordingPathInput.style.borderColor = '';
            }
        });

        // é€‰æ‹©å½•åˆ¶è·¯å¾„
        selectRecordingPathBtn.addEventListener('click', async () => {
            try {
                const result = await ipcRenderer.invoke('waapi-select-recording-path');
                if (!result.canceled && result.success) {
                    recordingPath = result.path;
                    recordingDir = result.directory;
                    recordingPathInput.value = result.path;
                    recordingPathInput.style.borderColor = '#28a745';
                }
            } catch (error) {
                alert('é€‰æ‹©è·¯å¾„å¤±è´¥: ' + error.message);
            }
        });

        // è·¯å¾„å¸®åŠ©æŒ‰é’®
        recordingPathHelpBtn.addEventListener('click', () => {
            recordingPathHelpText.style.display = recordingPathHelpText.style.display === 'none' ? 'block' : 'none';
        });

        // å½•åˆ¶æ¨¡å¼åˆ‡æ¢
        recordingModeRadios.forEach(radio => {
            radio.addEventListener('change', () => {
                if (radio.value === 'manual') {
                    recordingDurationGroup.style.display = 'flex';
                    recordingModeHint.textContent = typeof t === 'function' ? t('audioRecording.manualModeHint') : 'æŒç»­å½•åˆ¶åˆ°æŒ‡å®šæ—¶é•¿æ‰åœæ­¢';
                } else {
                    recordingDurationGroup.style.display = 'none';
                    recordingModeHint.textContent = typeof t === 'function' ? t('audioRecording.autoModeHint') : 'æ’­æ”¾å®Œæˆåè‡ªåŠ¨åœæ­¢';
                }
            });
        });

        // å¼€å§‹å½•åˆ¶
        startRecordingBtn.addEventListener('click', async () => {
            if (!recordingPath) {
                alert(typeof t === 'function' ? t('audioRecording.alertNoPath') : 'è¯·å…ˆè®¾ç½®å½•åˆ¶è·¯å¾„');
                return;
            }

            if (!isConnected) {
                alert(typeof t === 'function' ? t('audioRecording.alertNotConnected') : 'è¯·å…ˆè¿æ¥åˆ°Wwise');
                return;
            }

            const fs = require('fs');
            const path = require('path');
            
            // éªŒè¯è·¯å¾„
            let finalPath = recordingPath;
            let dirPath = path.dirname(finalPath);
            
            if (!finalPath.endsWith('Record.wav')) {
                dirPath = finalPath;
                finalPath = path.join(dirPath, 'Record.wav');
                recordingPathInput.value = finalPath;
            }

            // éªŒè¯ç›®å½•æ˜¯å¦å­˜åœ¨
            if (!fs.existsSync(dirPath)) {
                alert(typeof t === 'function' ? t('audioRecording.alertPathNotExist') : `å½•åˆ¶è·¯å¾„ä¸å­˜åœ¨: ${dirPath}`);
                return;
            }

            // éªŒè¯ç›®å½•æ˜¯å¦å¯å†™
            try {
                const testFile = path.join(dirPath, '.waapi_recorder_test');
                fs.writeFileSync(testFile, 'test');
                fs.unlinkSync(testFile);
            } catch (error) {
                alert(typeof t === 'function' ? t('audioRecording.alertPathNotWritable') : `å½•åˆ¶è·¯å¾„ä¸å¯å†™: ${dirPath}`);
                return;
            }

            recordingPath = finalPath;
            recordingDir = dirPath;

            const port = parseInt(portInput.value) || 8080;
            const recordingMode = document.querySelector('input[name="recordingMode"]:checked').value;
            const recordDuration = recordingMode === 'manual' ? parseFloat(recordingDurationInput.value) : null;

            if (recordingMode === 'manual' && (!recordDuration || recordDuration < 1 || recordDuration > 3600)) {
                alert(typeof t === 'function' ? t('audioRecording.alertInvalidDuration') : 'è¯·è¾“å…¥æœ‰æ•ˆçš„å½•åˆ¶æ—¶é•¿ï¼ˆ1-3600ç§’ï¼‰');
                return;
            }

            isRecording = true;
            startRecordingBtn.disabled = true;
            stopRecordingBtn.disabled = false;
            recordingProgressText.textContent = typeof t === 'function' ? t('audioRecording.recording') : 'æ­£åœ¨å½•åˆ¶...';
            recordingProgressBar.style.display = 'block';
            recordingProgressFill.style.width = '0%';
            recordedFiles = [];
            recordingResultsBody.innerHTML = '';
            openRecordingFolderBtn.style.display = 'none';

            try {
                const result = await ipcRenderer.invoke('waapi-start-recording', port, recordingPath, recordingMode, recordDuration);
                if (result.success) {
                    recordingProgressText.textContent = typeof t === 'function' ? t('audioRecording.complete', { count: result.count }) : `å½•åˆ¶å®Œæˆ - å…± ${result.count} ä¸ªå¯¹è±¡`;
                    if (result.files && result.files.length > 0) {
                        recordedFiles = result.files;
                        displayRecordingResults(result.files);
                    }
                } else {
                    recordingProgressText.textContent = typeof t === 'function' ? t('audioRecording.failed') : 'å½•åˆ¶å¤±è´¥';
                    alert((typeof t === 'function' ? t('audioRecording.alertFailed') : 'å½•åˆ¶å¤±è´¥') + ': ' + (result.error || 'Unknown error'));
                }
            } catch (error) {
                recordingProgressText.textContent = typeof t === 'function' ? t('audioRecording.failed') : 'å½•åˆ¶å¤±è´¥';
                alert((typeof t === 'function' ? t('audioRecording.alertFailed') : 'å½•åˆ¶å¤±è´¥') + ': ' + error.message);
            } finally {
                isRecording = false;
                startRecordingBtn.disabled = false;
                stopRecordingBtn.disabled = true;
                recordingProgressBar.style.display = 'none';
            }
        });

        // åœæ­¢å½•åˆ¶
        stopRecordingBtn.addEventListener('click', async () => {
            // åœæ­¢åŠŸèƒ½å¯ä»¥åœ¨è¿™é‡Œå®ç°ï¼Œç›®å‰å½•åˆ¶æ˜¯è‡ªåŠ¨å®Œæˆçš„
            isRecording = false;
            startRecordingBtn.disabled = false;
            stopRecordingBtn.disabled = true;
            recordingProgressText.textContent = typeof t === 'function' ? t('audioRecording.stopped') : 'å½•åˆ¶å·²åœæ­¢';
        });

        // ç›‘å¬å½•åˆ¶è¿›åº¦
        ipcRenderer.on('recording-progress', (event, progress) => {
            if (progress.type === 'progress') {
                const percent = Math.round((progress.current / progress.total) * 100);
                recordingProgressFill.style.width = percent + '%';
                recordingProgressText.textContent = typeof t === 'function' ? 
                    t('audioRecording.recordingProgress', { current: progress.current, total: progress.total, item: progress.item }) :
                    `æ­£åœ¨å½•åˆ¶: ${progress.item} (${progress.current}/${progress.total})`;
            } else if (progress.type === 'file') {
                if (progress.filePath && !recordedFiles.includes(progress.filePath)) {
                    recordedFiles.push(progress.filePath);
                }
            }
        });

        // ç›‘å¬å½•åˆ¶å®Œæˆäº‹ä»¶
        ipcRenderer.on('recording-complete', (event, data) => {
            if (data.files && data.files.length > 0) {
                recordedFiles = data.files;
                displayRecordingResults(data.files);
            }
        });

        // æ˜¾ç¤ºå½•åˆ¶ç»“æœ
        function displayRecordingResults(files) {
            recordingResultsBody.innerHTML = files.map((filePath, index) => {
                const path = require('path');
                const fileName = path.basename(filePath);
                return `
                    <tr>
                        <td>${index + 1}</td>
                        <td style="font-family: monospace; font-size: 12px;" title="${filePath}">${fileName}</td>
                        <td>
                            <button class="btn-success" onclick="openRecordingFile('${filePath.replace(/\\/g, '\\\\')}')" style="padding: 6px 12px; font-size: 12px;">
                                ${typeof t === 'function' ? t('audioRecording.openFile') : 'æ‰“å¼€æ–‡ä»¶'}
                            </button>
                        </td>
                    </tr>
                `;
            }).join('');
            openRecordingFolderBtn.style.display = 'inline-block';
        }

        // æ‰“å¼€å½•åˆ¶æ–‡ä»¶
        window.openRecordingFile = async (filePath) => {
            try {
                await ipcRenderer.invoke('waapi-open-file', filePath);
            } catch (error) {
                alert('æ‰“å¼€æ–‡ä»¶å¤±è´¥: ' + error.message);
            }
        };

        // æ‰“å¼€å½•åˆ¶æ–‡ä»¶å¤¹
        openRecordingFolderBtn.addEventListener('click', async () => {
            if (!recordingDir) {
                alert(typeof t === 'function' ? t('audioRecording.alertNoFolder') : 'å½•åˆ¶ç›®å½•è·¯å¾„ä¸å­˜åœ¨');
                return;
            }
            try {
                await ipcRenderer.invoke('waapi-open-folder', recordingDir);
            } catch (error) {
                alert('æ‰“å¼€æ–‡ä»¶å¤¹å¤±è´¥: ' + error.message);
            }
        });

    </script>
</body>
</html>

